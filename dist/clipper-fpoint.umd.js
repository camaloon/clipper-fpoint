!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e():"function"==typeof define&&define.amd?define(e):e()}(0,function(){var t={version:"6.4.2.2",use_lines:!1,use_xyz:!1},e=function(t,e){var i;if(void 0===Object.getOwnPropertyNames){for(i in e.prototype)void 0!==t.prototype[i]&&t.prototype[i]!==Object.prototype[i]||(t.prototype[i]=e.prototype[i]);for(i in e)void 0===t[i]&&(t[i]=e[i]);t.$baseCtor=e}else{for(var n=Object.getOwnPropertyNames(e.prototype),r=0;r<n.length;r++)void 0===Object.getOwnPropertyDescriptor(t.prototype,n[r])&&Object.defineProperty(t.prototype,n[r],Object.getOwnPropertyDescriptor(e.prototype,n[r]));for(i in e)void 0===t[i]&&(t[i]=e[i]);t.$baseCtor=e}};t.Path=function(){return[]},t.Path.prototype.push=Array.prototype.push,t.Paths=function(){return[]},t.Paths.prototype.push=Array.prototype.push,t.PolyNode=function(){this.m_Parent=null,this.m_polygon=new t.Path,this.m_Index=0,this.m_jointype=0,this.m_endtype=0,this.m_Childs=[],this.IsOpen=!1},t.PolyNode.prototype.IsHoleNode=function(){for(var t=!0,e=this.m_Parent;null!==e;)t=!t,e=e.m_Parent;return t},t.PolyNode.prototype.ChildCount=function(){return this.m_Childs.length},t.PolyNode.prototype.Contour=function(){return this.m_polygon},t.PolyNode.prototype.AddChild=function(t){var e=this.m_Childs.length;this.m_Childs.push(t),t.m_Parent=this,t.m_Index=e},t.PolyNode.prototype.GetNext=function(){return this.m_Childs.length>0?this.m_Childs[0]:this.GetNextSiblingUp()},t.PolyNode.prototype.GetNextSiblingUp=function(){return null===this.m_Parent?null:this.m_Index===this.m_Parent.m_Childs.length-1?this.m_Parent.GetNextSiblingUp():this.m_Parent.m_Childs[this.m_Index+1]},t.PolyNode.prototype.Childs=function(){return this.m_Childs},t.PolyNode.prototype.Parent=function(){return this.m_Parent},t.PolyNode.prototype.IsHole=function(){return this.IsHoleNode()},t.PolyTree=function(){this.m_AllPolys=[],t.PolyNode.call(this)},t.PolyTree.prototype.Clear=function(){for(var t=0,e=this.m_AllPolys.length;t<e;t++)this.m_AllPolys[t]=null;this.m_AllPolys.length=0,this.m_Childs.length=0},t.PolyTree.prototype.GetFirst=function(){return this.m_Childs.length>0?this.m_Childs[0]:null},t.PolyTree.prototype.Total=function(){var t=this.m_AllPolys.length;return t>0&&this.m_Childs[0]!==this.m_AllPolys[0]&&t--,t},e(t.PolyTree,t.PolyNode),t.Clear=function(t){t.length=0},t.PI=3.141592653589793,t.PI2=6.283185307179586,t.FPoint=function(){var e=arguments,i=e.length;if(this[0]=0,this[1]=0,t.use_xyz)if(this.Z=0,3===i)this[0]=e[0],this[1]=e[1],this.Z=e[2];else if(2===i)this[0]=e[0],this[1]=e[1],this.Z=0;else if(1===i)if(e[0]instanceof t.FPoint){var n=e[0];this[0]=n[0],this[1]=n[1],this.Z=0}else{void 0===(r=e[0]).Z&&(r.Z=0),this[0]=r[0],this[1]=r[1],this.Z=r.Z}else this[0]=0,this[1]=0,this.Z=0;else if(2===i)this[0]=e[0],this[1]=e[1];else if(1===i)if(e[0]instanceof t.FPoint){n=e[0];this[0]=n[0],this[1]=n[1]}else{var r=e[0];this[0]=r[0],this[1]=r[1]}else this[0]=0,this[1]=0},t.FPoint.op_Equality=function(t,e){return t[0]===e[0]&&t[1]===e[1]},t.FPoint.op_Inequality=function(t,e){return t[0]!==e[0]||t[1]!==e[1]},t.FPoint0=function(){this[0]=0,this[1]=0,t.use_xyz&&(this.Z=0)},t.FPoint0.prototype=t.FPoint.prototype,t.FPoint1=function(e){this[0]=e[0],this[1]=e[1],t.use_xyz&&(void 0===e.Z?this.Z=0:this.Z=e.Z)},t.FPoint1.prototype=t.FPoint.prototype,t.FPoint1dp=function(e){this[0]=e[0],this[1]=e[1],t.use_xyz&&(this.Z=0)},t.FPoint1dp.prototype=t.FPoint.prototype,t.FPoint2=function(e,i,n){this[0]=e,this[1]=i,t.use_xyz&&(this.Z=void 0===n?0:n)},t.FPoint2.prototype=t.FPoint.prototype,t.FRect=function(){var t=arguments,e=t.length;if(4===e)this.left=t[0],this.top=t[1],this.right=t[2],this.bottom=t[3];else if(1===e){var i=t[0];this.left=i.left,this.top=i.top,this.right=i.right,this.bottom=i.bottom}else this.left=0,this.top=0,this.right=0,this.bottom=0},t.FRect0=function(){this.left=0,this.top=0,this.right=0,this.bottom=0},t.FRect0.prototype=t.FRect.prototype,t.FRect1=function(t){this.left=t.left,this.top=t.top,this.right=t.right,this.bottom=t.bottom},t.FRect1.prototype=t.FRect.prototype,t.FRect4=function(t,e,i,n){this.left=t,this.top=e,this.right=i,this.bottom=n},t.FRect4.prototype=t.FRect.prototype,t.ClipType={ctIntersection:0,ctUnion:1,ctDifference:2,ctXor:3},t.PolyType={ptSubject:0,ptClip:1},t.PolyFillType={pftEvenOdd:0,pftNonZero:1,pftPositive:2,pftNegative:3},t.JoinType={jtSquare:0,jtRound:1,jtMiter:2},t.EndType={etOpenSquare:0,etOpenRound:1,etOpenButt:2,etClosedLine:3,etClosedPolygon:4},t.EdgeSide={esLeft:0,esRight:1},t.Direction={dRightToLeft:0,dLeftToRight:1},t.TEdge=function(){this.Bot=new t.FPoint0,this.Curr=new t.FPoint0,this.Top=new t.FPoint0,this.Delta=new t.FPoint0,this.Dx=0,this.PolyTyp=t.PolyType.ptSubject,this.Side=t.EdgeSide.esLeft,this.WindDelta=0,this.WindCnt=0,this.WindCnt2=0,this.OutIdx=0,this.Next=null,this.Prev=null,this.NextInLML=null,this.NextInAEL=null,this.PrevInAEL=null,this.NextInSEL=null,this.PrevInSEL=null},t.IntersectNode=function(){this.Edge1=null,this.Edge2=null,this.Pt=new t.FPoint0},t.MyIntersectNodeSort=function(){},t.MyIntersectNodeSort.Compare=function(t,e){var i=e.Pt[1]-t.Pt[1];return i>0?1:i<0?-1:0},t.LocalMinima=function(){this[1]=0,this.LeftBound=null,this.RightBound=null,this.Next=null},t.Scanbeam=function(){this[1]=0,this.Next=null},t.Maxima=function(){this[0]=0,this.Next=null,this.Prev=null},t.OutRec=function(){this.Idx=0,this.IsHole=!1,this.IsOpen=!1,this.FirstLeft=null,this.Pts=null,this.BottomPt=null,this.PolyNode=null},t.OutPt=function(){this.Idx=0,this.Pt=new t.FPoint0,this.Next=null,this.Prev=null},t.Join=function(){this.OutPt1=null,this.OutPt2=null,this.OffPt=new t.FPoint0},t.ClipperBase=function(){this.m_MinimaList=null,this.m_CurrentLM=null,this.m_edges=new Array,this.m_HasOpenPaths=!1,this.PreserveCollinear=!1,this.m_Scanbeam=null,this.m_PolyOuts=null,this.m_ActiveEdges=null},t.ClipperBase.horizontal=-3.4e38,t.ClipperBase.Skip=-2,t.ClipperBase.Unassigned=-1,t.ClipperBase.tolerance=1e-20,t.ClipperBase.maxValue=Math.sqrt(Number.MAX_VALUE),t.ClipperBase.minValue=Math.sqrt(Number.MIN_VALUE),t.ClipperBase.near_zero=function(e){return e>-t.ClipperBase.tolerance&&e<t.ClipperBase.tolerance},t.ClipperBase.IsHorizontal=function(t){return 0===t.Delta[1]},t.ClipperBase.prototype.PointIsVertex=function(e,i){var n=i;do{if(t.FPoint.op_Equality(n.Pt,e))return!0;n=n.Next}while(n!==i);return!1},t.ClipperBase.prototype.PointOnLineSegment=function(t,e,i){return t[0]===e[0]&&t[1]===e[1]||t[0]===i[0]&&t[1]===i[1]||t[0]>e[0]==t[0]<i[0]&&t[1]>e[1]==t[1]<i[1]&&(t[0]-e[0])*(i[1]-e[1])==(i[0]-e[0])*(t[1]-e[1])},t.ClipperBase.prototype.PointOnPolygon=function(t,e){for(var i=e;;){if(this.PointOnLineSegment(t,i.Pt,i.Next.Pt))return!0;if((i=i.Next)===e)break}return!1},t.ClipperBase.prototype.SlopesEqual=t.ClipperBase.SlopesEqual=function(){var t,e,i,n,r,o,l=arguments,s=l.length;return 2===s?(t=l[0],e=l[1],t.Delta[1]*e.Delta[0]==t.Delta[0]*e.Delta[1]):3===s?(i=l[0],n=l[1],r=l[2],(i[1]-n[1])*(n[0]-r[0])-(i[0]-n[0])*(n[1]-r[1])==0):(i=l[0],n=l[1],r=l[2],o=l[3],(i[1]-n[1])*(r[0]-o[0])-(i[0]-n[0])*(r[1]-o[1])==0)},t.ClipperBase.SlopesEqual3=function(t,e){return t.Delta[1]*e.Delta[0]==t.Delta[0]*e.Delta[1]},t.ClipperBase.SlopesEqual4=function(t,e,i){return(t[1]-e[1])*(e[0]-i[0])-(t[0]-e[0])*(e[1]-i[1])==0},t.ClipperBase.SlopesEqual5=function(t,e,i,n){return(t[1]-e[1])*(i[0]-n[0])-(t[0]-e[0])*(i[1]-n[1])==0},t.ClipperBase.prototype.Clear=function(){this.DisposeLocalMinimaList();for(var e=0,i=this.m_edges.length;e<i;++e){for(var n=0,r=this.m_edges[e].length;n<r;++n)this.m_edges[e][n]=null;t.Clear(this.m_edges[e])}t.Clear(this.m_edges),this.m_HasOpenPaths=!1},t.ClipperBase.prototype.DisposeLocalMinimaList=function(){for(;null!==this.m_MinimaList;){var t=this.m_MinimaList.Next;this.m_MinimaList=null,this.m_MinimaList=t}this.m_CurrentLM=null},t.ClipperBase.prototype.RangeTest=function(e){(e[0]>t.ClipperBase.maxValue||e[0]<-t.ClipperBase.maxValue||e[1]>t.ClipperBase.maxValue||e[1]<-t.ClipperBase.maxValue||e[0]>0&&e[0]<t.ClipperBase.minValue||e[1]>0&&e[1]<t.ClipperBase.minValue||e[0]<0&&e[0]>-t.ClipperBase.minValue||e[1]<0&&e[1]>-t.ClipperBase.minValue)&&t.Error("Coordinate outside allowed range in RangeTest().")},t.ClipperBase.prototype.InitEdge=function(e,i,n,r){e.Next=i,e.Prev=n,e.Curr[0]=r[0],e.Curr[1]=r[1],t.use_xyz&&(e.Curr.Z=r.Z),e.OutIdx=-1},t.ClipperBase.prototype.InitEdge2=function(e,i){e.Curr[1]>=e.Next.Curr[1]?(e.Bot[0]=e.Curr[0],e.Bot[1]=e.Curr[1],t.use_xyz&&(e.Bot.Z=e.Curr.Z),e.Top[0]=e.Next.Curr[0],e.Top[1]=e.Next.Curr[1],t.use_xyz&&(e.Top.Z=e.Next.Curr.Z)):(e.Top[0]=e.Curr[0],e.Top[1]=e.Curr[1],t.use_xyz&&(e.Top.Z=e.Curr.Z),e.Bot[0]=e.Next.Curr[0],e.Bot[1]=e.Next.Curr[1],t.use_xyz&&(e.Bot.Z=e.Next.Curr.Z)),this.SetDx(e),e.PolyTyp=i},t.ClipperBase.prototype.FindNextLocMin=function(e){for(var i;;){for(;t.FPoint.op_Inequality(e.Bot,e.Prev.Bot)||t.FPoint.op_Equality(e.Curr,e.Top);)e=e.Next;if(e.Dx!==t.ClipperBase.horizontal&&e.Prev.Dx!==t.ClipperBase.horizontal)break;for(;e.Prev.Dx===t.ClipperBase.horizontal;)e=e.Prev;for(i=e;e.Dx===t.ClipperBase.horizontal;)e=e.Next;if(e.Top[1]!==e.Prev.Bot[1]){i.Prev.Bot[0]<e.Bot[0]&&(e=i);break}}return e},t.ClipperBase.prototype.ProcessBound=function(e,i){var n,r,o=e;if(o.OutIdx===t.ClipperBase.Skip){if(e=o,i){for(;e.Top[1]===e.Next.Bot[1];)e=e.Next;for(;e!==o&&e.Dx===t.ClipperBase.horizontal;)e=e.Prev}else{for(;e.Top[1]===e.Prev.Bot[1];)e=e.Prev;for(;e!==o&&e.Dx===t.ClipperBase.horizontal;)e=e.Next}if(e===o)o=i?e.Next:e.Prev;else{e=i?o.Next:o.Prev;var l=new t.LocalMinima;l.Next=null,l[1]=e.Bot[1],l.LeftBound=null,l.RightBound=e,e.WindDelta=0,o=this.ProcessBound(e,i),this.InsertLocalMinima(l)}return o}if(e.Dx===t.ClipperBase.horizontal&&((n=i?e.Prev:e.Next).Dx===t.ClipperBase.horizontal?n.Bot[0]!==e.Bot[0]&&n.Top[0]!==e.Bot[0]&&this.ReverseHorizontal(e):n.Bot[0]!==e.Bot[0]&&this.ReverseHorizontal(e)),n=e,i){for(;o.Top[1]===o.Next.Bot[1]&&o.Next.OutIdx!==t.ClipperBase.Skip;)o=o.Next;if(o.Dx===t.ClipperBase.horizontal&&o.Next.OutIdx!==t.ClipperBase.Skip){for(r=o;r.Prev.Dx===t.ClipperBase.horizontal;)r=r.Prev;r.Prev.Top[0]>o.Next.Top[0]&&(o=r.Prev)}for(;e!==o;)e.NextInLML=e.Next,e.Dx===t.ClipperBase.horizontal&&e!==n&&e.Bot[0]!==e.Prev.Top[0]&&this.ReverseHorizontal(e),e=e.Next;e.Dx===t.ClipperBase.horizontal&&e!==n&&e.Bot[0]!==e.Prev.Top[0]&&this.ReverseHorizontal(e),o=o.Next}else{for(;o.Top[1]===o.Prev.Bot[1]&&o.Prev.OutIdx!==t.ClipperBase.Skip;)o=o.Prev;if(o.Dx===t.ClipperBase.horizontal&&o.Prev.OutIdx!==t.ClipperBase.Skip){for(r=o;r.Next.Dx===t.ClipperBase.horizontal;)r=r.Next;(r.Next.Top[0]===o.Prev.Top[0]||r.Next.Top[0]>o.Prev.Top[0])&&(o=r.Next)}for(;e!==o;)e.NextInLML=e.Prev,e.Dx===t.ClipperBase.horizontal&&e!==n&&e.Bot[0]!==e.Next.Top[0]&&this.ReverseHorizontal(e),e=e.Prev;e.Dx===t.ClipperBase.horizontal&&e!==n&&e.Bot[0]!==e.Next.Top[0]&&this.ReverseHorizontal(e),o=o.Prev}return o},t.ClipperBase.prototype.AddPath=function(e,i,n){var r=this;t.use_lines?n||i!==t.PolyType.ptClip||t.Error("AddPath: Open paths must be subject."):n||t.Error("AddPath: Open paths have been disabled.");var o=e.length-1;if(n)for(;o>0&&t.FPoint.op_Equality(e[o],e[0]);)--o;for(;o>0&&t.FPoint.op_Equality(e[o],e[o-1]);)--o;if(n&&o<2||!n&&o<1)return!1;for(var l=new Array,s=0;s<=o;s++)l.push(new t.TEdge);var p=!0;l[1].Curr[0]=e[1][0],l[1].Curr[1]=e[1][1],t.use_xyz&&(l[1].Curr.Z=e[1].Z),this.RangeTest(e[0]),this.RangeTest(e[o]),this.InitEdge(l[0],l[1],l[o],e[0]),this.InitEdge(l[o],l[0],l[o-1],e[o]);for(s=o-1;s>=1;--s)r.RangeTest(e[s]),r.InitEdge(l[s],l[s+1],l[s-1],e[s]);for(var u,a=l[0],P=a,d=a;;)if(P.Curr!==P.Next.Curr||!n&&P.Next===a){if(P.Prev===P.Next)break;if(!n||!t.ClipperBase.SlopesEqual4(P.Prev.Curr,P.Curr,P.Next.Curr)||r.PreserveCollinear&&r.Pt2IsBetweenPt1AndPt3(P.Prev.Curr,P.Curr,P.Next.Curr)){if((P=P.Next)===d||!n&&P.Next===a)break}else P===a&&(a=P.Next),d=P=(P=r.RemoveEdge(P)).Prev}else{if(P===P.Next)break;P===a&&(a=P.Next),d=P=r.RemoveEdge(P)}if(!n&&P===P.Next||n&&P.Prev===P.Next)return!1;n||(this.m_HasOpenPaths=!0,a.Prev.OutIdx=t.ClipperBase.Skip),P=a;do{r.InitEdge2(P,i),P=P.Next,p&&P.Curr[1]!==a.Curr[1]&&(p=!1)}while(P!==a);if(p){if(n)return!1;for(P.Prev.OutIdx=t.ClipperBase.Skip,(f=new t.LocalMinima).Next=null,f[1]=P.Bot[1],f.LeftBound=null,f.RightBound=P,f.RightBound.Side=t.EdgeSide.esRight,f.RightBound.WindDelta=0;P.Bot[0]!==P.Prev.Top[0]&&r.ReverseHorizontal(P),P.Next.OutIdx!==t.ClipperBase.Skip;)P.NextInLML=P.Next,P=P.Next;return this.InsertLocalMinima(f),this.m_edges.push(l),!0}this.m_edges.push(l);var h=null;for(t.FPoint.op_Equality(P.Prev.Bot,P.Prev.Top)&&(P=P.Next);(P=r.FindNextLocMin(P))!==h;){var f;null===h&&(h=P),(f=new t.LocalMinima).Next=null,f[1]=P.Bot[1],P.Dx<P.Prev.Dx?(f.LeftBound=P.Prev,f.RightBound=P,u=!1):(f.LeftBound=P,f.RightBound=P.Prev,u=!0),f.LeftBound.Side=t.EdgeSide.esLeft,f.RightBound.Side=t.EdgeSide.esRight,n?f.LeftBound.Next===f.RightBound?f.LeftBound.WindDelta=-1:f.LeftBound.WindDelta=1:f.LeftBound.WindDelta=0,f.RightBound.WindDelta=-f.LeftBound.WindDelta,(P=r.ProcessBound(f.LeftBound,u)).OutIdx===t.ClipperBase.Skip&&(P=r.ProcessBound(P,u));var y=r.ProcessBound(f.RightBound,!u);y.OutIdx===t.ClipperBase.Skip&&(y=r.ProcessBound(y,!u)),f.LeftBound.OutIdx===t.ClipperBase.Skip?f.LeftBound=null:f.RightBound.OutIdx===t.ClipperBase.Skip&&(f.RightBound=null),r.InsertLocalMinima(f),u||(P=y)}return!0},t.ClipperBase.prototype.AddPaths=function(t,e,i){for(var n=!1,r=0,o=t.length;r<o;++r)this.AddPath(t[r],e,i)&&(n=!0);return n},t.ClipperBase.prototype.Pt2IsBetweenPt1AndPt3=function(e,i,n){return!(t.FPoint.op_Equality(e,n)||t.FPoint.op_Equality(e,i)||t.FPoint.op_Equality(n,i))&&(e[0]!==n[0]?i[0]>e[0]==i[0]<n[0]:i[1]>e[1]==i[1]<n[1])},t.ClipperBase.prototype.RemoveEdge=function(t){t.Prev.Next=t.Next,t.Next.Prev=t.Prev;var e=t.Next;return t.Prev=null,e},t.ClipperBase.prototype.SetDx=function(e){e.Delta[0]=e.Top[0]-e.Bot[0],e.Delta[1]=e.Top[1]-e.Bot[1],0===e.Delta[1]?e.Dx=t.ClipperBase.horizontal:e.Dx=e.Delta[0]/e.Delta[1]},t.ClipperBase.prototype.InsertLocalMinima=function(t){if(null===this.m_MinimaList)this.m_MinimaList=t;else if(t[1]>=this.m_MinimaList[1])t.Next=this.m_MinimaList,this.m_MinimaList=t;else{for(var e=this.m_MinimaList;null!==e.Next&&t[1]<e.Next[1];)e=e.Next;t.Next=e.Next,e.Next=t}},t.ClipperBase.prototype.PopLocalMinima=function(t,e){return e.v=this.m_CurrentLM,null!==this.m_CurrentLM&&this.m_CurrentLM[1]===t&&(this.m_CurrentLM=this.m_CurrentLM.Next,!0)},t.ClipperBase.prototype.ReverseHorizontal=function(e){var i=e.Top[0];e.Top[0]=e.Bot[0],e.Bot[0]=i,t.use_xyz&&(i=e.Top.Z,e.Top.Z=e.Bot.Z,e.Bot.Z=i)},t.ClipperBase.prototype.Reset=function(){if(this.m_CurrentLM=this.m_MinimaList,null!==this.m_CurrentLM){this.m_Scanbeam=null;for(var e=this.m_MinimaList;null!==e;){this.InsertScanbeam(e[1]);var i=e.LeftBound;null!==i&&(i.Curr[0]=i.Bot[0],i.Curr[1]=i.Bot[1],t.use_xyz&&(i.Curr.Z=i.Bot.Z),i.OutIdx=t.ClipperBase.Unassigned),null!==(i=e.RightBound)&&(i.Curr[0]=i.Bot[0],i.Curr[1]=i.Bot[1],t.use_xyz&&(i.Curr.Z=i.Bot.Z),i.OutIdx=t.ClipperBase.Unassigned),e=e.Next}this.m_ActiveEdges=null}},t.ClipperBase.prototype.InsertScanbeam=function(e){if(null===this.m_Scanbeam)this.m_Scanbeam=new t.Scanbeam,this.m_Scanbeam.Next=null,this.m_Scanbeam[1]=e;else if(e>this.m_Scanbeam[1]){var i=new t.Scanbeam;i[1]=e,i.Next=this.m_Scanbeam,this.m_Scanbeam=i}else{for(var n=this.m_Scanbeam;null!==n.Next&&e<=n.Next[1];)n=n.Next;if(e===n[1])return;var r=new t.Scanbeam;r[1]=e,r.Next=n.Next,n.Next=r}},t.ClipperBase.prototype.PopScanbeam=function(t){return null===this.m_Scanbeam?(t.v=0,!1):(t.v=this.m_Scanbeam[1],this.m_Scanbeam=this.m_Scanbeam.Next,!0)},t.ClipperBase.prototype.LocalMinimaPending=function(){return null!==this.m_CurrentLM},t.ClipperBase.prototype.CreateOutRec=function(){var e=new t.OutRec;return e.Idx=t.ClipperBase.Unassigned,e.IsHole=!1,e.IsOpen=!1,e.FirstLeft=null,e.Pts=null,e.BottomPt=null,e.PolyNode=null,this.m_PolyOuts.push(e),e.Idx=this.m_PolyOuts.length-1,e},t.ClipperBase.prototype.DisposeOutRec=function(t){var e=this.m_PolyOuts[t];e.Pts=null,e=null,this.m_PolyOuts[t]=null},t.ClipperBase.prototype.UpdateEdgeIntoAEL=function(e){null===e.NextInLML&&t.Error("UpdateEdgeIntoAEL: invalid call");var i=e.PrevInAEL,n=e.NextInAEL;return e.NextInLML.OutIdx=e.OutIdx,null!==i?i.NextInAEL=e.NextInLML:this.m_ActiveEdges=e.NextInLML,null!==n&&(n.PrevInAEL=e.NextInLML),e.NextInLML.Side=e.Side,e.NextInLML.WindDelta=e.WindDelta,e.NextInLML.WindCnt=e.WindCnt,e.NextInLML.WindCnt2=e.WindCnt2,(e=e.NextInLML).Curr[0]=e.Bot[0],e.Curr[1]=e.Bot[1],e.PrevInAEL=i,e.NextInAEL=n,t.ClipperBase.IsHorizontal(e)||this.InsertScanbeam(e.Top[1]),e},t.ClipperBase.prototype.SwapPositionsInAEL=function(t,e){if(t.NextInAEL!==t.PrevInAEL&&e.NextInAEL!==e.PrevInAEL){if(t.NextInAEL===e){var i=e.NextInAEL;null!==i&&(i.PrevInAEL=t);var n=t.PrevInAEL;null!==n&&(n.NextInAEL=e),e.PrevInAEL=n,e.NextInAEL=t,t.PrevInAEL=e,t.NextInAEL=i}else if(e.NextInAEL===t){var r=t.NextInAEL;null!==r&&(r.PrevInAEL=e);var o=e.PrevInAEL;null!==o&&(o.NextInAEL=t),t.PrevInAEL=o,t.NextInAEL=e,e.PrevInAEL=t,e.NextInAEL=r}else{var l=t.NextInAEL,s=t.PrevInAEL;t.NextInAEL=e.NextInAEL,null!==t.NextInAEL&&(t.NextInAEL.PrevInAEL=t),t.PrevInAEL=e.PrevInAEL,null!==t.PrevInAEL&&(t.PrevInAEL.NextInAEL=t),e.NextInAEL=l,null!==e.NextInAEL&&(e.NextInAEL.PrevInAEL=e),e.PrevInAEL=s,null!==e.PrevInAEL&&(e.PrevInAEL.NextInAEL=e)}null===t.PrevInAEL?this.m_ActiveEdges=t:null===e.PrevInAEL&&(this.m_ActiveEdges=e)}},t.ClipperBase.prototype.DeleteFromAEL=function(t){var e=t.PrevInAEL,i=t.NextInAEL;null===e&&null===i&&t!==this.m_ActiveEdges||(null!==e?e.NextInAEL=i:this.m_ActiveEdges=i,null!==i&&(i.PrevInAEL=e),t.NextInAEL=null,t.PrevInAEL=null)},t.Clipper=function(e){void 0===e&&(e=0),this.m_PolyOuts=null,this.m_ClipType=t.ClipType.ctIntersection,this.m_Scanbeam=null,this.m_Maxima=null,this.m_ActiveEdges=null,this.m_SortedEdges=null,this.m_IntersectList=null,this.m_IntersectNodeComparer=null,this.m_ExecuteLocked=!1,this.m_ClipFillType=t.PolyFillType.pftEvenOdd,this.m_SubjFillType=t.PolyFillType.pftEvenOdd,this.m_Joins=null,this.m_GhostJoins=null,this.m_UsingPolyTree=!1,this.ReverseSolution=!1,this.StrictlySimple=!1,t.ClipperBase.call(this),this.m_Scanbeam=null,this.m_Maxima=null,this.m_ActiveEdges=null,this.m_SortedEdges=null,this.m_IntersectList=new Array,this.m_IntersectNodeComparer=t.MyIntersectNodeSort.Compare,this.m_ExecuteLocked=!1,this.m_UsingPolyTree=!1,this.m_PolyOuts=new Array,this.m_Joins=new Array,this.m_GhostJoins=new Array,this.ReverseSolution=0!=(1&e),this.StrictlySimple=0!=(2&e),this.PreserveCollinear=0!=(4&e),t.use_xyz&&(this.ZFillFunction=null)},t.Clipper.ioReverseSolution=1,t.Clipper.ioStrictlySimple=2,t.Clipper.ioPreserveCollinear=4,t.Clipper.prototype.Clear=function(){0!==this.m_edges.length&&(this.DisposeAllPolyPts(),t.ClipperBase.prototype.Clear.call(this))},t.Clipper.prototype.InsertMaxima=function(e){var i=new t.Maxima;if(i[0]=e,null===this.m_Maxima)this.m_Maxima=i,this.m_Maxima.Next=null,this.m_Maxima.Prev=null;else if(e<this.m_Maxima[0])i.Next=this.m_Maxima,i.Prev=null,this.m_Maxima=i;else{for(var n=this.m_Maxima;null!==n.Next&&e>=n.Next[0];)n=n.Next;if(e===n[0])return;i.Next=n.Next,i.Prev=n,null!==n.Next&&(n.Next.Prev=i),n.Next=i}},t.Clipper.prototype.Execute=function(){var e=arguments,i=e.length,n=e[1]instanceof t.PolyTree;if(4===i&&!n){var r=e[0],o=e[1],l=e[2],s=e[3];if(this.m_ExecuteLocked)return!1;this.m_HasOpenPaths&&t.Error("Error: PolyTree struct is needed for open path clipping."),this.m_ExecuteLocked=!0,t.Clear(o),this.m_SubjFillType=l,this.m_ClipFillType=s,this.m_ClipType=r,this.m_UsingPolyTree=!1;try{(u=this.ExecuteInternal())&&this.BuildResult(o)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return u}if(4===i&&n){r=e[0];var p=e[1];l=e[2],s=e[3];if(this.m_ExecuteLocked)return!1;this.m_ExecuteLocked=!0,this.m_SubjFillType=l,this.m_ClipFillType=s,this.m_ClipType=r,this.m_UsingPolyTree=!0;try{var u;(u=this.ExecuteInternal())&&this.BuildResult2(p)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return u}if(2===i&&!n){r=e[0],o=e[1];return this.Execute(r,o,t.PolyFillType.pftEvenOdd,t.PolyFillType.pftEvenOdd)}if(2===i&&n){r=e[0],p=e[1];return this.Execute(r,p,t.PolyFillType.pftEvenOdd,t.PolyFillType.pftEvenOdd)}},t.Clipper.prototype.FixHoleLinkage=function(t){if(null!==t.FirstLeft&&(t.IsHole===t.FirstLeft.IsHole||null===t.FirstLeft.Pts)){for(var e=t.FirstLeft;null!==e&&(e.IsHole===t.IsHole||null===e.Pts);)e=e.FirstLeft;t.FirstLeft=e}},t.Clipper.prototype.ExecuteInternal=function(){var t=this;try{this.Reset(),this.m_SortedEdges=null,this.m_Maxima=null;var e,i,n,r={},o={};if(!this.PopScanbeam(r))return!1;for(this.InsertLocalMinimaIntoAEL(r.v);this.PopScanbeam(o)||this.LocalMinimaPending();){if(t.ProcessHorizontals(),t.m_GhostJoins.length=0,!t.ProcessIntersections(o.v))return!1;t.ProcessEdgesAtTopOfScanbeam(o.v),r.v=o.v,t.InsertLocalMinimaIntoAEL(r.v)}for(i=0,n=this.m_PolyOuts.length;i<n;i++)null===(e=t.m_PolyOuts[i]).Pts||e.IsOpen||(e.IsHole^t.ReverseSolution)==t.Area$1(e)>0&&t.ReversePolyPtLinks(e.Pts);for(this.JoinCommonEdges(),i=0,n=this.m_PolyOuts.length;i<n;i++)null!==(e=t.m_PolyOuts[i]).Pts&&(e.IsOpen?t.FixupOutPolyline(e):t.FixupOutPolygon(e));return this.StrictlySimple&&this.DoSimplePolygons(),!0}finally{this.m_Joins.length=0,this.m_GhostJoins.length=0}},t.Clipper.prototype.DisposeAllPolyPts=function(){for(var e=0,i=this.m_PolyOuts.length;e<i;++e)this.DisposeOutRec(e);t.Clear(this.m_PolyOuts)},t.Clipper.prototype.AddJoin=function(e,i,n){var r=new t.Join;r.OutPt1=e,r.OutPt2=i,r.OffPt[0]=n[0],r.OffPt[1]=n[1],t.use_xyz&&(r.OffPt.Z=n.Z),this.m_Joins.push(r)},t.Clipper.prototype.AddGhostJoin=function(e,i){var n=new t.Join;n.OutPt1=e,n.OffPt[0]=i[0],n.OffPt[1]=i[1],t.use_xyz&&(n.OffPt.Z=i.Z),this.m_GhostJoins.push(n)},t.Clipper.prototype.SetZ=function(e,i,n){if(null!==this.ZFillFunction){if(0!==e.Z||null===this.ZFillFunction)return;t.FPoint.op_Equality(e,i.Bot)?e.Z=i.Bot.Z:t.FPoint.op_Equality(e,i.Top)?e.Z=i.Top.Z:t.FPoint.op_Equality(e,n.Bot)?e.Z=n.Bot.Z:t.FPoint.op_Equality(e,n.Top)?e.Z=n.Top.Z:this.ZFillFunction(i.Bot,i.Top,n.Bot,n.Top,e)}},t.Clipper.prototype.InsertLocalMinimaIntoAEL=function(e){for(var i,n,r=this,o={};this.PopLocalMinima(e,o);){i=o.v.LeftBound,n=o.v.RightBound;var l=null;if(null===i?(r.InsertEdgeIntoAEL(n,null),r.SetWindingCount(n),r.IsContributing(n)&&(l=r.AddOutPt(n,n.Bot))):null===n?(r.InsertEdgeIntoAEL(i,null),r.SetWindingCount(i),r.IsContributing(i)&&(l=r.AddOutPt(i,i.Bot)),r.InsertScanbeam(i.Top[1])):(r.InsertEdgeIntoAEL(i,null),r.InsertEdgeIntoAEL(n,i),r.SetWindingCount(i),n.WindCnt=i.WindCnt,n.WindCnt2=i.WindCnt2,r.IsContributing(i)&&(l=r.AddLocalMinPoly(i,n,i.Bot)),r.InsertScanbeam(i.Top[1])),null!==n&&(t.ClipperBase.IsHorizontal(n)?(null!==n.NextInLML&&r.InsertScanbeam(n.NextInLML.Top[1]),r.AddEdgeToSEL(n)):r.InsertScanbeam(n.Top[1])),null!==i&&null!==n){if(null!==l&&t.ClipperBase.IsHorizontal(n)&&r.m_GhostJoins.length>0&&0!==n.WindDelta)for(var s=0,p=this.m_GhostJoins.length;s<p;s++){var u=r.m_GhostJoins[s];r.HorzSegmentsOverlap(u.OutPt1.Pt[0],u.OffPt[0],n.Bot[0],n.Top[0])&&r.AddJoin(u.OutPt1,l,u.OffPt)}if(i.OutIdx>=0&&null!==i.PrevInAEL&&i.PrevInAEL.Curr[0]===i.Bot[0]&&i.PrevInAEL.OutIdx>=0&&t.ClipperBase.SlopesEqual5(i.PrevInAEL.Curr,i.PrevInAEL.Top,i.Curr,i.Top)&&0!==i.WindDelta&&0!==i.PrevInAEL.WindDelta){var a=r.AddOutPt(i.PrevInAEL,i.Bot);r.AddJoin(l,a,i.Top)}if(i.NextInAEL!==n){if(n.OutIdx>=0&&n.PrevInAEL.OutIdx>=0&&t.ClipperBase.SlopesEqual5(n.PrevInAEL.Curr,n.PrevInAEL.Top,n.Curr,n.Top)&&0!==n.WindDelta&&0!==n.PrevInAEL.WindDelta){a=r.AddOutPt(n.PrevInAEL,n.Bot);r.AddJoin(l,a,n.Top)}var P=i.NextInAEL;if(null!==P)for(;P!==n;)r.IntersectEdges(n,P,i.Curr),P=P.NextInAEL}}}},t.Clipper.prototype.InsertEdgeIntoAEL=function(t,e){if(null===this.m_ActiveEdges)t.PrevInAEL=null,t.NextInAEL=null,this.m_ActiveEdges=t;else if(null===e&&this.E2InsertsBeforeE1(this.m_ActiveEdges,t))t.PrevInAEL=null,t.NextInAEL=this.m_ActiveEdges,this.m_ActiveEdges.PrevInAEL=t,this.m_ActiveEdges=t;else{for(null===e&&(e=this.m_ActiveEdges);null!==e.NextInAEL&&!this.E2InsertsBeforeE1(e.NextInAEL,t);)e=e.NextInAEL;t.NextInAEL=e.NextInAEL,null!==e.NextInAEL&&(e.NextInAEL.PrevInAEL=t),t.PrevInAEL=e,e.NextInAEL=t}},t.Clipper.prototype.E2InsertsBeforeE1=function(e,i){return i.Curr[0]===e.Curr[0]?i.Top[1]>e.Top[1]?i.Top[0]<t.Clipper.TopX(e,i.Top[1]):e.Top[0]>t.Clipper.TopX(i,e.Top[1]):i.Curr[0]<e.Curr[0]},t.Clipper.prototype.IsEvenOddFillType=function(e){return e.PolyTyp===t.PolyType.ptSubject?this.m_SubjFillType===t.PolyFillType.pftEvenOdd:this.m_ClipFillType===t.PolyFillType.pftEvenOdd},t.Clipper.prototype.IsEvenOddAltFillType=function(e){return e.PolyTyp===t.PolyType.ptSubject?this.m_ClipFillType===t.PolyFillType.pftEvenOdd:this.m_SubjFillType===t.PolyFillType.pftEvenOdd},t.Clipper.prototype.IsContributing=function(e){var i,n;switch(e.PolyTyp===t.PolyType.ptSubject?(i=this.m_SubjFillType,n=this.m_ClipFillType):(i=this.m_ClipFillType,n=this.m_SubjFillType),i){case t.PolyFillType.pftEvenOdd:if(0===e.WindDelta&&1!==e.WindCnt)return!1;break;case t.PolyFillType.pftNonZero:if(1!==Math.abs(e.WindCnt))return!1;break;case t.PolyFillType.pftPositive:if(1!==e.WindCnt)return!1;break;default:if(-1!==e.WindCnt)return!1}switch(this.m_ClipType){case t.ClipType.ctIntersection:switch(n){case t.PolyFillType.pftEvenOdd:case t.PolyFillType.pftNonZero:return 0!==e.WindCnt2;case t.PolyFillType.pftPositive:return e.WindCnt2>0;default:return e.WindCnt2<0}case t.ClipType.ctUnion:switch(n){case t.PolyFillType.pftEvenOdd:case t.PolyFillType.pftNonZero:return 0===e.WindCnt2;case t.PolyFillType.pftPositive:return e.WindCnt2<=0;default:return e.WindCnt2>=0}case t.ClipType.ctDifference:if(e.PolyTyp===t.PolyType.ptSubject)switch(n){case t.PolyFillType.pftEvenOdd:case t.PolyFillType.pftNonZero:return 0===e.WindCnt2;case t.PolyFillType.pftPositive:return e.WindCnt2<=0;default:return e.WindCnt2>=0}else switch(n){case t.PolyFillType.pftEvenOdd:case t.PolyFillType.pftNonZero:return 0!==e.WindCnt2;case t.PolyFillType.pftPositive:return e.WindCnt2>0;default:return e.WindCnt2<0}case t.ClipType.ctXor:if(0!==e.WindDelta)return!0;switch(n){case t.PolyFillType.pftEvenOdd:case t.PolyFillType.pftNonZero:return 0===e.WindCnt2;case t.PolyFillType.pftPositive:return e.WindCnt2<=0;default:return e.WindCnt2>=0}}return!0},t.Clipper.prototype.SetWindingCount=function(e){for(var i=e.PrevInAEL;null!==i&&(i.PolyTyp!==e.PolyTyp||0===i.WindDelta);)i=i.PrevInAEL;if(null===i){var n=e.PolyTyp===t.PolyType.ptSubject?this.m_SubjFillType:this.m_ClipFillType;0===e.WindDelta?e.WindCnt=n===t.PolyFillType.pftNegative?-1:1:e.WindCnt=e.WindDelta,e.WindCnt2=0,i=this.m_ActiveEdges}else if(0===e.WindDelta&&this.m_ClipType!==t.ClipType.ctUnion)e.WindCnt=1,e.WindCnt2=i.WindCnt2,i=i.NextInAEL;else if(this.IsEvenOddFillType(e)){if(0===e.WindDelta){for(var r=!0,o=i.PrevInAEL;null!==o;)o.PolyTyp===i.PolyTyp&&0!==o.WindDelta&&(r=!r),o=o.PrevInAEL;e.WindCnt=r?0:1}else e.WindCnt=e.WindDelta;e.WindCnt2=i.WindCnt2,i=i.NextInAEL}else i.WindCnt*i.WindDelta<0?Math.abs(i.WindCnt)>1?i.WindDelta*e.WindDelta<0?e.WindCnt=i.WindCnt:e.WindCnt=i.WindCnt+e.WindDelta:e.WindCnt=0===e.WindDelta?1:e.WindDelta:0===e.WindDelta?e.WindCnt=i.WindCnt<0?i.WindCnt-1:i.WindCnt+1:i.WindDelta*e.WindDelta<0?e.WindCnt=i.WindCnt:e.WindCnt=i.WindCnt+e.WindDelta,e.WindCnt2=i.WindCnt2,i=i.NextInAEL;if(this.IsEvenOddAltFillType(e))for(;i!==e;)0!==i.WindDelta&&(e.WindCnt2=0===e.WindCnt2?1:0),i=i.NextInAEL;else for(;i!==e;)e.WindCnt2+=i.WindDelta,i=i.NextInAEL},t.Clipper.prototype.AddEdgeToSEL=function(t){null===this.m_SortedEdges?(this.m_SortedEdges=t,t.PrevInSEL=null,t.NextInSEL=null):(t.NextInSEL=this.m_SortedEdges,t.PrevInSEL=null,this.m_SortedEdges.PrevInSEL=t,this.m_SortedEdges=t)},t.Clipper.prototype.PopEdgeFromSEL=function(t){if(t.v=this.m_SortedEdges,null===t.v)return!1;var e=t.v;return this.m_SortedEdges=t.v.NextInSEL,null!==this.m_SortedEdges&&(this.m_SortedEdges.PrevInSEL=null),e.NextInSEL=null,e.PrevInSEL=null,!0},t.Clipper.prototype.CopyAELToSEL=function(){var t=this.m_ActiveEdges;for(this.m_SortedEdges=t;null!==t;)t.PrevInSEL=t.PrevInAEL,t.NextInSEL=t.NextInAEL,t=t.NextInAEL},t.Clipper.prototype.SwapPositionsInSEL=function(t,e){if(!(null===t.NextInSEL&&null===t.PrevInSEL||null===e.NextInSEL&&null===e.PrevInSEL)){if(t.NextInSEL===e)null!==(i=e.NextInSEL)&&(i.PrevInSEL=t),null!==(n=t.PrevInSEL)&&(n.NextInSEL=e),e.PrevInSEL=n,e.NextInSEL=t,t.PrevInSEL=e,t.NextInSEL=i;else if(e.NextInSEL===t){null!==(i=t.NextInSEL)&&(i.PrevInSEL=e),null!==(n=e.PrevInSEL)&&(n.NextInSEL=t),t.PrevInSEL=n,t.NextInSEL=e,e.PrevInSEL=t,e.NextInSEL=i}else{var i=t.NextInSEL,n=t.PrevInSEL;t.NextInSEL=e.NextInSEL,null!==t.NextInSEL&&(t.NextInSEL.PrevInSEL=t),t.PrevInSEL=e.PrevInSEL,null!==t.PrevInSEL&&(t.PrevInSEL.NextInSEL=t),e.NextInSEL=i,null!==e.NextInSEL&&(e.NextInSEL.PrevInSEL=e),e.PrevInSEL=n,null!==e.PrevInSEL&&(e.PrevInSEL.NextInSEL=e)}null===t.PrevInSEL?this.m_SortedEdges=t:null===e.PrevInSEL&&(this.m_SortedEdges=e)}},t.Clipper.prototype.AddLocalMaxPoly=function(t,e,i){this.AddOutPt(t,i),0===e.WindDelta&&this.AddOutPt(e,i),t.OutIdx===e.OutIdx?(t.OutIdx=-1,e.OutIdx=-1):t.OutIdx<e.OutIdx?this.AppendPolygon(t,e):this.AppendPolygon(e,t)},t.Clipper.prototype.AddLocalMinPoly=function(e,i,n){var r,o,l;if(t.ClipperBase.IsHorizontal(i)||e.Dx>i.Dx?(r=this.AddOutPt(e,n),i.OutIdx=e.OutIdx,e.Side=t.EdgeSide.esLeft,i.Side=t.EdgeSide.esRight,l=(o=e).PrevInAEL===i?i.PrevInAEL:o.PrevInAEL):(r=this.AddOutPt(i,n),e.OutIdx=i.OutIdx,e.Side=t.EdgeSide.esRight,i.Side=t.EdgeSide.esLeft,l=(o=i).PrevInAEL===e?e.PrevInAEL:o.PrevInAEL),null!==l&&l.OutIdx>=0&&l.Top[1]<n[1]&&o.Top[1]<n[1]){var s=t.Clipper.TopX(l,n[1]),p=t.Clipper.TopX(o,n[1]);if(s===p&&0!==o.WindDelta&&0!==l.WindDelta&&t.ClipperBase.SlopesEqual5(new t.FPoint2(s,n[1]),l.Top,new t.FPoint2(p,n[1]),o.Top)){var u=this.AddOutPt(l,n);this.AddJoin(r,u,o.Top)}}return r},t.Clipper.prototype.AddOutPt=function(e,i){if(e.OutIdx<0){(r=this.CreateOutRec()).IsOpen=0===e.WindDelta;var n=new t.OutPt;return r.Pts=n,n.Idx=r.Idx,n.Pt[0]=i[0],n.Pt[1]=i[1],t.use_xyz&&(n.Pt.Z=i.Z),n.Next=n,n.Prev=n,r.IsOpen||this.SetHoleState(e,r),e.OutIdx=r.Idx,n}var r,o=(r=this.m_PolyOuts[e.OutIdx]).Pts,l=e.Side===t.EdgeSide.esLeft;return l&&t.FPoint.op_Equality(i,o.Pt)?o:!l&&t.FPoint.op_Equality(i,o.Prev.Pt)?o.Prev:((n=new t.OutPt).Idx=r.Idx,n.Pt[0]=i[0],n.Pt[1]=i[1],t.use_xyz&&(n.Pt.Z=i.Z),n.Next=o,n.Prev=o.Prev,n.Prev.Next=n,o.Prev=n,l&&(r.Pts=n),n)},t.Clipper.prototype.GetLastOutPt=function(e){var i=this.m_PolyOuts[e.OutIdx];return e.Side===t.EdgeSide.esLeft?i.Pts:i.Pts.Prev},t.Clipper.prototype.SwapPoints=function(e,i){var n=new t.FPoint1(e.Value);e.Value[0]=i.Value[0],e.Value[1]=i.Value[1],t.use_xyz&&(e.Value.Z=i.Value.Z),i.Value[0]=n[0],i.Value[1]=n[1],t.use_xyz&&(i.Value.Z=n.Z)},t.Clipper.prototype.HorzSegmentsOverlap=function(t,e,i,n){var r;return t>e&&(r=t,t=e,e=r),i>n&&(r=i,i=n,n=r),t<n&&i<e},t.Clipper.prototype.SetHoleState=function(t,e){for(var i=t.PrevInAEL,n=null;null!==i;)i.OutIdx>=0&&0!==i.WindDelta&&(null===n?n=i:n.OutIdx===i.OutIdx&&(n=null)),i=i.PrevInAEL;null===n?(e.FirstLeft=null,e.IsHole=!1):(e.FirstLeft=this.m_PolyOuts[n.OutIdx],e.IsHole=!e.FirstLeft.IsHole)},t.Clipper.prototype.GetDx=function(e,i){return e[1]===i[1]?t.ClipperBase.horizontal:(i[0]-e[0])/(i[1]-e[1])},t.Clipper.prototype.FirstIsBottomPt=function(e,i){for(var n=e.Prev;t.FPoint.op_Equality(n.Pt,e.Pt)&&n!==e;)n=n.Prev;var r=Math.abs(this.GetDx(e.Pt,n.Pt));for(n=e.Next;t.FPoint.op_Equality(n.Pt,e.Pt)&&n!==e;)n=n.Next;var o=Math.abs(this.GetDx(e.Pt,n.Pt));for(n=i.Prev;t.FPoint.op_Equality(n.Pt,i.Pt)&&n!==i;)n=n.Prev;var l=Math.abs(this.GetDx(i.Pt,n.Pt));for(n=i.Next;t.FPoint.op_Equality(n.Pt,i.Pt)&&n!==i;)n=n.Next;var s=Math.abs(this.GetDx(i.Pt,n.Pt));return Math.max(r,o)===Math.max(l,s)&&Math.min(r,o)===Math.min(l,s)?this.Area(e)>0:r>=l&&r>=s||o>=l&&o>=s},t.Clipper.prototype.GetBottomPt=function(e){for(var i=null,n=e.Next;n!==e;)n.Pt[1]>e.Pt[1]?(e=n,i=null):n.Pt[1]===e.Pt[1]&&n.Pt[0]<=e.Pt[0]&&(n.Pt[0]<e.Pt[0]?(i=null,e=n):n.Next!==e&&n.Prev!==e&&(i=n)),n=n.Next;if(null!==i)for(;i!==n;)for(this.FirstIsBottomPt(n,i)||(e=i),i=i.Next;t.FPoint.op_Inequality(i.Pt,e.Pt);)i=i.Next;return e},t.Clipper.prototype.GetLowermostRec=function(t,e){null===t.BottomPt&&(t.BottomPt=this.GetBottomPt(t.Pts)),null===e.BottomPt&&(e.BottomPt=this.GetBottomPt(e.Pts));var i=t.BottomPt,n=e.BottomPt;return i.Pt[1]>n.Pt[1]?t:i.Pt[1]<n.Pt[1]?e:i.Pt[0]<n.Pt[0]?t:i.Pt[0]>n.Pt[0]?e:i.Next===i?e:n.Next===n?t:this.FirstIsBottomPt(i,n)?t:e},t.Clipper.prototype.OutRec1RightOfOutRec2=function(t,e){do{if((t=t.FirstLeft)===e)return!0}while(null!==t);return!1},t.Clipper.prototype.GetOutRec=function(t){for(var e=this.m_PolyOuts[t];e!==this.m_PolyOuts[e.Idx];)e=this.m_PolyOuts[e.Idx];return e},t.Clipper.prototype.AppendPolygon=function(e,i){var n,r=this.m_PolyOuts[e.OutIdx],o=this.m_PolyOuts[i.OutIdx];n=this.OutRec1RightOfOutRec2(r,o)?o:this.OutRec1RightOfOutRec2(o,r)?r:this.GetLowermostRec(r,o);var l=r.Pts,s=l.Prev,p=o.Pts,u=p.Prev;e.Side===t.EdgeSide.esLeft?i.Side===t.EdgeSide.esLeft?(this.ReversePolyPtLinks(p),p.Next=l,l.Prev=p,s.Next=u,u.Prev=s,r.Pts=u):(u.Next=l,l.Prev=u,p.Prev=s,s.Next=p,r.Pts=p):i.Side===t.EdgeSide.esRight?(this.ReversePolyPtLinks(p),s.Next=u,u.Prev=s,p.Next=l,l.Prev=p):(s.Next=p,p.Prev=s,l.Prev=u,u.Next=l),r.BottomPt=null,n===o&&(o.FirstLeft!==r&&(r.FirstLeft=o.FirstLeft),r.IsHole=o.IsHole),o.Pts=null,o.BottomPt=null,o.FirstLeft=r;var a=e.OutIdx,P=i.OutIdx;e.OutIdx=-1,i.OutIdx=-1;for(var d=this.m_ActiveEdges;null!==d;){if(d.OutIdx===P){d.OutIdx=a,d.Side=e.Side;break}d=d.NextInAEL}o.Idx=r.Idx},t.Clipper.prototype.ReversePolyPtLinks=function(t){if(null!==t){var e,i;e=t;do{i=e.Next,e.Next=e.Prev,e.Prev=i,e=i}while(e!==t)}},t.Clipper.SwapSides=function(t,e){var i=t.Side;t.Side=e.Side,e.Side=i},t.Clipper.SwapPolyIndexes=function(t,e){var i=t.OutIdx;t.OutIdx=e.OutIdx,e.OutIdx=i},t.Clipper.prototype.IntersectEdges=function(e,i,n){var r=e.OutIdx>=0,o=i.OutIdx>=0;if(t.use_xyz&&this.SetZ(n,e,i),!t.use_lines||0!==e.WindDelta&&0!==i.WindDelta){if(e.PolyTyp===i.PolyTyp)if(this.IsEvenOddFillType(e)){var l=e.WindCnt;e.WindCnt=i.WindCnt,i.WindCnt=l}else e.WindCnt+i.WindDelta===0?e.WindCnt=-e.WindCnt:e.WindCnt+=i.WindDelta,i.WindCnt-e.WindDelta==0?i.WindCnt=-i.WindCnt:i.WindCnt-=e.WindDelta;else this.IsEvenOddFillType(i)?e.WindCnt2=0===e.WindCnt2?1:0:e.WindCnt2+=i.WindDelta,this.IsEvenOddFillType(e)?i.WindCnt2=0===i.WindCnt2?1:0:i.WindCnt2-=e.WindDelta;var s,p,u,a,P,d;switch(e.PolyTyp===t.PolyType.ptSubject?(s=this.m_SubjFillType,u=this.m_ClipFillType):(s=this.m_ClipFillType,u=this.m_SubjFillType),i.PolyTyp===t.PolyType.ptSubject?(p=this.m_SubjFillType,a=this.m_ClipFillType):(p=this.m_ClipFillType,a=this.m_SubjFillType),s){case t.PolyFillType.pftPositive:P=e.WindCnt;break;case t.PolyFillType.pftNegative:P=-e.WindCnt;break;default:P=Math.abs(e.WindCnt)}switch(p){case t.PolyFillType.pftPositive:d=i.WindCnt;break;case t.PolyFillType.pftNegative:d=-i.WindCnt;break;default:d=Math.abs(i.WindCnt)}if(r&&o)0!==P&&1!==P||0!==d&&1!==d||e.PolyTyp!==i.PolyTyp&&this.m_ClipType!==t.ClipType.ctXor?this.AddLocalMaxPoly(e,i,n):(this.AddOutPt(e,n),this.AddOutPt(i,n),t.Clipper.SwapSides(e,i),t.Clipper.SwapPolyIndexes(e,i));else if(r)0!==d&&1!==d||(this.AddOutPt(e,n),t.Clipper.SwapSides(e,i),t.Clipper.SwapPolyIndexes(e,i));else if(o)0!==P&&1!==P||(this.AddOutPt(i,n),t.Clipper.SwapSides(e,i),t.Clipper.SwapPolyIndexes(e,i));else if(!(0!==P&&1!==P||0!==d&&1!==d)){var h,f;switch(u){case t.PolyFillType.pftPositive:h=e.WindCnt2;break;case t.PolyFillType.pftNegative:h=-e.WindCnt2;break;default:h=Math.abs(e.WindCnt2)}switch(a){case t.PolyFillType.pftPositive:f=i.WindCnt2;break;case t.PolyFillType.pftNegative:f=-i.WindCnt2;break;default:f=Math.abs(i.WindCnt2)}if(e.PolyTyp!==i.PolyTyp)this.AddLocalMinPoly(e,i,n);else if(1===P&&1===d)switch(this.m_ClipType){case t.ClipType.ctIntersection:h>0&&f>0&&this.AddLocalMinPoly(e,i,n);break;case t.ClipType.ctUnion:h<=0&&f<=0&&this.AddLocalMinPoly(e,i,n);break;case t.ClipType.ctDifference:(e.PolyTyp===t.PolyType.ptClip&&h>0&&f>0||e.PolyTyp===t.PolyType.ptSubject&&h<=0&&f<=0)&&this.AddLocalMinPoly(e,i,n);break;case t.ClipType.ctXor:this.AddLocalMinPoly(e,i,n)}else t.Clipper.SwapSides(e,i)}}else{if(0===e.WindDelta&&0===i.WindDelta)return;e.PolyTyp===i.PolyTyp&&e.WindDelta!==i.WindDelta&&this.m_ClipType===t.ClipType.ctUnion?0===e.WindDelta?o&&(this.AddOutPt(e,n),r&&(e.OutIdx=-1)):r&&(this.AddOutPt(i,n),o&&(i.OutIdx=-1)):e.PolyTyp!==i.PolyTyp&&(0!==e.WindDelta||1!==Math.abs(i.WindCnt)||this.m_ClipType===t.ClipType.ctUnion&&0!==i.WindCnt2?0!==i.WindDelta||1!==Math.abs(e.WindCnt)||this.m_ClipType===t.ClipType.ctUnion&&0!==e.WindCnt2||(this.AddOutPt(i,n),o&&(i.OutIdx=-1)):(this.AddOutPt(e,n),r&&(e.OutIdx=-1)))}},t.Clipper.prototype.DeleteFromSEL=function(t){var e=t.PrevInSEL,i=t.NextInSEL;null===e&&null===i&&t!==this.m_SortedEdges||(null!==e?e.NextInSEL=i:this.m_SortedEdges=i,null!==i&&(i.PrevInSEL=e),t.NextInSEL=null,t.PrevInSEL=null)},t.Clipper.prototype.ProcessHorizontals=function(){for(var t={};this.PopEdgeFromSEL(t);)this.ProcessHorizontal(t.v)},t.Clipper.prototype.GetHorzDirection=function(e,i){e.Bot[0]<e.Top[0]?(i.Left=e.Bot[0],i.Right=e.Top[0],i.Dir=t.Direction.dLeftToRight):(i.Left=e.Top[0],i.Right=e.Bot[0],i.Dir=t.Direction.dRightToLeft)},t.Clipper.prototype.ProcessHorizontal=function(e){var i=this,n={Dir:null,Left:null,Right:null};this.GetHorzDirection(e,n);for(var r=n.Dir,o=n.Left,l=n.Right,s=0===e.WindDelta,p=e,u=null;null!==p.NextInLML&&t.ClipperBase.IsHorizontal(p.NextInLML);)p=p.NextInLML;null===p.NextInLML&&(u=this.GetMaximaPair(p));var a=this.m_Maxima;if(null!==a)if(r===t.Direction.dLeftToRight){for(;null!==a&&a[0]<=e.Bot[0];)a=a.Next;null!==a&&a[0]>=p.Top[0]&&(a=null)}else{for(;null!==a.Next&&a.Next[0]<e.Bot[0];)a=a.Next;a[0]<=p.Top[0]&&(a=null)}for(var P=null;;){for(var d=e===p,h=i.GetNextInAEL(e,r);null!==h;){if(null!==a)if(r===t.Direction.dLeftToRight)for(;null!==a&&a[0]<h.Curr[0];)e.OutIdx>=0&&!s&&i.AddOutPt(e,new t.FPoint2(a[0],e.Bot[1])),a=a.Next;else for(;null!==a&&a[0]>h.Curr[0];)e.OutIdx>=0&&!s&&i.AddOutPt(e,new t.FPoint2(a[0],e.Bot[1])),a=a.Prev;if(r===t.Direction.dLeftToRight&&h.Curr[0]>l||r===t.Direction.dRightToLeft&&h.Curr[0]<o)break;if(h.Curr[0]===e.Top[0]&&null!==e.NextInLML&&h.Dx<e.NextInLML.Dx)break;if(e.OutIdx>=0&&!s){t.use_xyz&&(r===t.Direction.dLeftToRight?i.SetZ(h.Curr,e,h):i.SetZ(h.Curr,h,e)),P=i.AddOutPt(e,h.Curr);for(var f=i.m_SortedEdges;null!==f;){if(f.OutIdx>=0&&i.HorzSegmentsOverlap(e.Bot[0],e.Top[0],f.Bot[0],f.Top[0])){var y=i.GetLastOutPt(f);i.AddJoin(y,P,f.Top)}f=f.NextInSEL}i.AddGhostJoin(P,e.Bot)}if(h===u&&d)return e.OutIdx>=0&&i.AddLocalMaxPoly(e,u,e.Top),i.DeleteFromAEL(e),void i.DeleteFromAEL(u);if(r===t.Direction.dLeftToRight){var m=new t.FPoint2(h.Curr[0],e.Curr[1]);i.IntersectEdges(e,h,m)}else{m=new t.FPoint2(h.Curr[0],e.Curr[1]);i.IntersectEdges(h,e,m)}var C=i.GetNextInAEL(h,r);i.SwapPositionsInAEL(e,h),h=C}if(null===e.NextInLML||!t.ClipperBase.IsHorizontal(e.NextInLML))break;(e=i.UpdateEdgeIntoAEL(e)).OutIdx>=0&&i.AddOutPt(e,e.Bot),n={Dir:r,Left:o,Right:l},i.GetHorzDirection(e,n),r=n.Dir,o=n.Left,l=n.Right}if(e.OutIdx>=0&&null===P){P=this.GetLastOutPt(e);for(f=this.m_SortedEdges;null!==f;){if(f.OutIdx>=0&&i.HorzSegmentsOverlap(e.Bot[0],e.Top[0],f.Bot[0],f.Top[0])){y=i.GetLastOutPt(f);i.AddJoin(y,P,f.Top)}f=f.NextInSEL}this.AddGhostJoin(P,e.Top)}if(null!==e.NextInLML)if(e.OutIdx>=0){if(P=this.AddOutPt(e,e.Top),0===(e=this.UpdateEdgeIntoAEL(e)).WindDelta)return;var x=e.PrevInAEL;C=e.NextInAEL;if(null!==x&&x.Curr[0]===e.Bot[0]&&x.Curr[1]===e.Bot[1]&&0===x.WindDelta&&x.OutIdx>=0&&x.Curr[1]>x.Top[1]&&t.ClipperBase.SlopesEqual3(e,x)){y=this.AddOutPt(x,e.Bot);this.AddJoin(P,y,e.Top)}else if(null!==C&&C.Curr[0]===e.Bot[0]&&C.Curr[1]===e.Bot[1]&&0!==C.WindDelta&&C.OutIdx>=0&&C.Curr[1]>C.Top[1]&&t.ClipperBase.SlopesEqual3(e,C)){y=this.AddOutPt(C,e.Bot);this.AddJoin(P,y,e.Top)}}else e=this.UpdateEdgeIntoAEL(e);else e.OutIdx>=0&&this.AddOutPt(e,e.Top),this.DeleteFromAEL(e)},t.Clipper.prototype.GetNextInAEL=function(e,i){return i===t.Direction.dLeftToRight?e.NextInAEL:e.PrevInAEL},t.Clipper.prototype.IsMinima=function(t){return null!==t&&t.Prev.NextInLML!==t&&t.Next.NextInLML!==t},t.Clipper.prototype.IsMaxima=function(t,e){return null!==t&&t.Top[1]===e&&null===t.NextInLML},t.Clipper.prototype.IsIntermediate=function(t,e){return t.Top[1]===e&&null!==t.NextInLML},t.Clipper.prototype.GetMaximaPair=function(e){return t.FPoint.op_Equality(e.Next.Top,e.Top)&&null===e.Next.NextInLML?e.Next:t.FPoint.op_Equality(e.Prev.Top,e.Top)&&null===e.Prev.NextInLML?e.Prev:null},t.Clipper.prototype.GetMaximaPairEx=function(e){var i=this.GetMaximaPair(e);return null===i||i.OutIdx===t.ClipperBase.Skip||i.NextInAEL===i.PrevInAEL&&!t.ClipperBase.IsHorizontal(i)?null:i},t.Clipper.prototype.ProcessIntersections=function(e){if(null===this.m_ActiveEdges)return!0;try{if(this.BuildIntersectList(e),0===this.m_IntersectList.length)return!0;if(1!==this.m_IntersectList.length&&!this.FixupIntersectionOrder())return!1;this.ProcessIntersectList()}catch(e){this.m_SortedEdges=null,this.m_IntersectList.length=0,t.Error("ProcessIntersections error")}return this.m_SortedEdges=null,!0},t.Clipper.prototype.BuildIntersectList=function(e){if(null!==this.m_ActiveEdges){var i=this.m_ActiveEdges;for(this.m_SortedEdges=i;null!==i;)i.PrevInSEL=i.PrevInAEL,i.NextInSEL=i.NextInAEL,i.Curr[0]=t.Clipper.TopX(i,e),i=i.NextInAEL;for(var n=!0;n&&null!==this.m_SortedEdges;){for(n=!1,i=this.m_SortedEdges;null!==i.NextInSEL;){var r=i.NextInSEL,o=new t.FPoint0;if(i.Curr[0]>r.Curr[0]){this.IntersectPoint(i,r,o),o[1]<e&&(o=new t.FPoint2(t.Clipper.TopX(i,e),e));var l=new t.IntersectNode;l.Edge1=i,l.Edge2=r,l.Pt[0]=o[0],l.Pt[1]=o[1],t.use_xyz&&(l.Pt.Z=o.Z),this.m_IntersectList.push(l),this.SwapPositionsInSEL(i,r),n=!0}else i=r}if(null===i.PrevInSEL)break;i.PrevInSEL.NextInSEL=null}this.m_SortedEdges=null}},t.Clipper.prototype.EdgesAdjacent=function(t){return t.Edge1.NextInSEL===t.Edge2||t.Edge1.PrevInSEL===t.Edge2},t.Clipper.IntersectNodeSort=function(t,e){return e.Pt[1]-t.Pt[1]},t.Clipper.prototype.FixupIntersectionOrder=function(){var t=this;this.m_IntersectList.sort(this.m_IntersectNodeComparer),this.CopyAELToSEL();for(var e=this.m_IntersectList.length,i=0;i<e;i++){if(!t.EdgesAdjacent(t.m_IntersectList[i])){for(var n=i+1;n<e&&!this.EdgesAdjacent(this.m_IntersectList[n]);)n++;if(n===e)return!1;var r=t.m_IntersectList[i];t.m_IntersectList[i]=t.m_IntersectList[n],t.m_IntersectList[n]=r}t.SwapPositionsInSEL(t.m_IntersectList[i].Edge1,t.m_IntersectList[i].Edge2)}return!0},t.Clipper.prototype.ProcessIntersectList=function(){for(var t=0,e=this.m_IntersectList.length;t<e;t++){var i=this.m_IntersectList[t];this.IntersectEdges(i.Edge1,i.Edge2,i.Pt),this.SwapPositionsInAEL(i.Edge1,i.Edge2)}this.m_IntersectList.length=0},t.Clipper.TopX=function(t,e){return e===t.Top[1]?t.Top[0]:t.Bot[0]+t.Dx*(e-t.Bot[1])},t.Clipper.prototype.IntersectPoint=function(e,i,n){var r,o;if(n[0]=0,n[1]=0,e.Dx===i.Dx)return n[1]=e.Curr[1],void(n[0]=t.Clipper.TopX(e,n[1]));if(0===e.Delta[0])n[0]=e.Bot[0],t.ClipperBase.IsHorizontal(i)?n[1]=i.Bot[1]:(o=i.Bot[1]-i.Bot[0]/i.Dx,n[1]=n[0]/i.Dx+o);else if(0===i.Delta[0])n[0]=i.Bot[0],t.ClipperBase.IsHorizontal(e)?n[1]=e.Bot[1]:(r=e.Bot[1]-e.Bot[0]/e.Dx,n[1]=n[0]/e.Dx+r);else{r=e.Bot[0]-e.Bot[1]*e.Dx;var l=((o=i.Bot[0]-i.Bot[1]*i.Dx)-r)/(e.Dx-i.Dx);n[1]=l,Math.abs(e.Dx)<Math.abs(i.Dx)?n[0]=e.Dx*l+r:n[0]=i.Dx*l+o}if(n[1]<e.Top[1]||n[1]<i.Top[1]){if(e.Top[1]>i.Top[1])return n[1]=e.Top[1],n[0]=t.Clipper.TopX(i,e.Top[1]),n[0]<e.Top[0];n[1]=i.Top[1],Math.abs(e.Dx)<Math.abs(i.Dx)?n[0]=t.Clipper.TopX(e,n[1]):n[0]=t.Clipper.TopX(i,n[1])}n[1]>e.Curr[1]&&(n[1]=e.Curr[1],Math.abs(e.Dx)>Math.abs(i.Dx)?n[0]=t.Clipper.TopX(i,n[1]):n[0]=t.Clipper.TopX(e,n[1]))},t.Clipper.prototype.ProcessEdgesAtTopOfScanbeam=function(e){for(var i=this,n=this.m_ActiveEdges;null!==n;){var r=i.IsMaxima(n,e);if(r){var o=i.GetMaximaPairEx(n);r=null===o||!t.ClipperBase.IsHorizontal(o)}if(r){i.StrictlySimple&&i.InsertMaxima(n.Top[0]);var l=n.PrevInAEL;i.DoMaxima(n),n=null===l?i.m_ActiveEdges:l.NextInAEL}else{if(i.IsIntermediate(n,e)&&t.ClipperBase.IsHorizontal(n.NextInLML)?((n=i.UpdateEdgeIntoAEL(n)).OutIdx>=0&&i.AddOutPt(n,n.Bot),i.AddEdgeToSEL(n)):(n.Curr[0]=t.Clipper.TopX(n,e),n.Curr[1]=e),t.use_xyz&&(n.Top[1]===e?n.Curr.Z=n.Top.Z:n.Bot[1]===e?n.Curr.Z=n.Bot.Z:n.Curr.Z=0),i.StrictlySimple){l=n.PrevInAEL;if(n.OutIdx>=0&&0!==n.WindDelta&&null!==l&&l.OutIdx>=0&&l.Curr[0]===n.Curr[0]&&0!==l.WindDelta){var s=new t.FPoint1(n.Curr);t.use_xyz&&i.SetZ(s,l,n);var p=i.AddOutPt(l,s),u=i.AddOutPt(n,s);i.AddJoin(p,u,s)}}n=n.NextInAEL}}for(this.ProcessHorizontals(),this.m_Maxima=null,n=this.m_ActiveEdges;null!==n;){if(i.IsIntermediate(n,e)){p=null;n.OutIdx>=0&&(p=i.AddOutPt(n,n.Top));l=(n=i.UpdateEdgeIntoAEL(n)).PrevInAEL;var a=n.NextInAEL;if(null!==l&&l.Curr[0]===n.Bot[0]&&l.Curr[1]===n.Bot[1]&&null!==p&&l.OutIdx>=0&&l.Curr[1]===l.Top[1]&&t.ClipperBase.SlopesEqual5(n.Curr,n.Top,l.Curr,l.Top)&&0!==n.WindDelta&&0!==l.WindDelta){u=i.AddOutPt(ePrev2,n.Bot);i.AddJoin(p,u,n.Top)}else if(null!==a&&a.Curr[0]===n.Bot[0]&&a.Curr[1]===n.Bot[1]&&null!==p&&a.OutIdx>=0&&a.Curr[1]===a.Top[1]&&t.ClipperBase.SlopesEqual5(n.Curr,n.Top,a.Curr,a.Top)&&0!==n.WindDelta&&0!==a.WindDelta){u=i.AddOutPt(a,n.Bot);i.AddJoin(p,u,n.Top)}}n=n.NextInAEL}},t.Clipper.prototype.DoMaxima=function(e){var i=this.GetMaximaPairEx(e);if(null===i)return e.OutIdx>=0&&this.AddOutPt(e,e.Top),void this.DeleteFromAEL(e);for(var n=e.NextInAEL;null!==n&&n!==i;)this.IntersectEdges(e,n,e.Top),this.SwapPositionsInAEL(e,n),n=e.NextInAEL;-1===e.OutIdx&&-1===i.OutIdx?(this.DeleteFromAEL(e),this.DeleteFromAEL(i)):e.OutIdx>=0&&i.OutIdx>=0?(e.OutIdx>=0&&this.AddLocalMaxPoly(e,i,e.Top),this.DeleteFromAEL(e),this.DeleteFromAEL(i)):t.use_lines&&0===e.WindDelta?(e.OutIdx>=0&&(this.AddOutPt(e,e.Top),e.OutIdx=t.ClipperBase.Unassigned),this.DeleteFromAEL(e),i.OutIdx>=0&&(this.AddOutPt(i,e.Top),i.OutIdx=t.ClipperBase.Unassigned),this.DeleteFromAEL(i)):t.Error("DoMaxima error")},t.Clipper.ReversePaths=function(t){for(var e=0,i=t.length;e<i;e++)t[e].reverse()},t.Clipper.Orientation=function(e){return t.Clipper.Area(e)>=0},t.Clipper.prototype.PointCount=function(t){if(null===t)return 0;var e=0,i=t;do{e++,i=i.Next}while(i!==t);return e},t.Clipper.prototype.BuildResult=function(e){t.Clear(e);for(var i=0,n=this.m_PolyOuts.length;i<n;i++){var r=this.m_PolyOuts[i];if(null!==r.Pts){var o=r.Pts.Prev,l=this.PointCount(o);if(!(l<2)){for(var s=new Array(l),p=0;p<l;p++)s[p]=o.Pt,o=o.Prev;e.push(s)}}}},t.Clipper.prototype.BuildResult2=function(e){e.Clear();for(var i=0,n=this.m_PolyOuts.length;i<n;i++){var r=this.m_PolyOuts[i],o=this.PointCount(r.Pts);if(!(r.IsOpen&&o<2||!r.IsOpen&&o<3)){this.FixHoleLinkage(r);var l=new t.PolyNode;e.m_AllPolys.push(l),r.PolyNode=l,l.m_polygon.length=o;for(var s=r.Pts.Prev,p=0;p<o;p++)l.m_polygon[p]=s.Pt,s=s.Prev}}for(i=0,n=this.m_PolyOuts.length;i<n;i++){null!==(r=this.m_PolyOuts[i]).PolyNode&&(r.IsOpen?(r.PolyNode.IsOpen=!0,e.AddChild(r.PolyNode)):null!==r.FirstLeft&&null!==r.FirstLeft.PolyNode?r.FirstLeft.PolyNode.AddChild(r.PolyNode):e.AddChild(r.PolyNode))}},t.Clipper.prototype.FixupOutPolyline=function(e){for(var i=e.Pts,n=i.Prev;i!==n;)if(i=i.Next,t.FPoint.op_Equality(i.Pt,i.Prev.Pt)){i===n&&(n=i.Prev);var r=i.Prev;r.Next=i.Next,i.Next.Prev=r,i=r}i===i.Prev&&(e.Pts=null)},t.Clipper.prototype.FixupOutPolygon=function(e){var i=null;e.BottomPt=null;for(var n=e.Pts,r=this.PreserveCollinear||this.StrictlySimple;;){if(n.Prev===n||n.Prev===n.Next)return void(e.Pts=null);if(t.FPoint.op_Equality(n.Pt,n.Next.Pt)||t.FPoint.op_Equality(n.Pt,n.Prev.Pt)||t.ClipperBase.SlopesEqual4(n.Prev.Pt,n.Pt,n.Next.Pt)&&(!r||!this.Pt2IsBetweenPt1AndPt3(n.Prev.Pt,n.Pt,n.Next.Pt)))i=null,n.Prev.Next=n.Next,n.Next.Prev=n.Prev,n=n.Prev;else{if(n===i)break;null===i&&(i=n),n=n.Next}}e.Pts=n},t.Clipper.prototype.DupOutPt=function(e,i){var n=new t.OutPt;return n.Pt[0]=e.Pt[0],n.Pt[1]=e.Pt[1],t.use_xyz&&(n.Pt.Z=e.Pt.Z),n.Idx=e.Idx,i?(n.Next=e.Next,n.Prev=e,e.Next.Prev=n,e.Next=n):(n.Prev=e.Prev,n.Next=e,e.Prev.Next=n,e.Prev=n),n},t.Clipper.prototype.GetOverlap=function(t,e,i,n,r){return t<e?i<n?(r.Left=Math.max(t,i),r.Right=Math.min(e,n)):(r.Left=Math.max(t,n),r.Right=Math.min(e,i)):i<n?(r.Left=Math.max(e,i),r.Right=Math.min(t,n)):(r.Left=Math.max(e,n),r.Right=Math.min(t,i)),r.Left<r.Right},t.Clipper.prototype.JoinHorz=function(e,i,n,r,o,l){var s=e.Pt[0]>i.Pt[0]?t.Direction.dRightToLeft:t.Direction.dLeftToRight,p=n.Pt[0]>r.Pt[0]?t.Direction.dRightToLeft:t.Direction.dLeftToRight;if(s===p)return!1;if(s===t.Direction.dLeftToRight){for(;e.Next.Pt[0]<=o[0]&&e.Next.Pt[0]>=e.Pt[0]&&e.Next.Pt[1]===o[1];)e=e.Next;l&&e.Pt[0]!==o[0]&&(e=e.Next),i=this.DupOutPt(e,!l),t.FPoint.op_Inequality(i.Pt,o)&&((e=i).Pt[0]=o[0],e.Pt[1]=o[1],t.use_xyz&&(e.Pt.Z=o.Z),i=this.DupOutPt(e,!l))}else{for(;e.Next.Pt[0]>=o[0]&&e.Next.Pt[0]<=e.Pt[0]&&e.Next.Pt[1]===o[1];)e=e.Next;l||e.Pt[0]===o[0]||(e=e.Next),i=this.DupOutPt(e,l),t.FPoint.op_Inequality(i.Pt,o)&&((e=i).Pt[0]=o[0],e.Pt[1]=o[1],t.use_xyz&&(e.Pt.Z=o.Z),i=this.DupOutPt(e,l))}if(p===t.Direction.dLeftToRight){for(;n.Next.Pt[0]<=o[0]&&n.Next.Pt[0]>=n.Pt[0]&&n.Next.Pt[1]===o[1];)n=n.Next;l&&n.Pt[0]!==o[0]&&(n=n.Next),r=this.DupOutPt(n,!l),t.FPoint.op_Inequality(r.Pt,o)&&((n=r).Pt[0]=o[0],n.Pt[1]=o[1],t.use_xyz&&(n.Pt.Z=o.Z),r=this.DupOutPt(n,!l))}else{for(;n.Next.Pt[0]>=o[0]&&n.Next.Pt[0]<=n.Pt[0]&&n.Next.Pt[1]===o[1];)n=n.Next;l||n.Pt[0]===o[0]||(n=n.Next),r=this.DupOutPt(n,l),t.FPoint.op_Inequality(r.Pt,o)&&((n=r).Pt[0]=o[0],n.Pt[1]=o[1],t.use_xyz&&(n.Pt.Z=o.Z),r=this.DupOutPt(n,l))}return s===t.Direction.dLeftToRight===l?(e.Prev=n,n.Next=e,i.Next=r,r.Prev=i):(e.Next=n,n.Prev=e,i.Prev=r,r.Next=i),!0},t.Clipper.prototype.JoinPoints=function(e,i,n){var r=e.OutPt1,o=new t.OutPt,l=e.OutPt2,s=new t.OutPt,p=e.OutPt1.Pt[1]===e.OffPt[1];if(p&&t.FPoint.op_Equality(e.OffPt,e.OutPt1.Pt)&&t.FPoint.op_Equality(e.OffPt,e.OutPt2.Pt)){if(i!==n)return!1;for(o=e.OutPt1.Next;o!==r&&t.FPoint.op_Equality(o.Pt,e.OffPt);)o=o.Next;var u=o.Pt[1]>e.OffPt[1];for(s=e.OutPt2.Next;s!==l&&t.FPoint.op_Equality(s.Pt,e.OffPt);)s=s.Next;return u!==s.Pt[1]>e.OffPt[1]&&(u?(o=this.DupOutPt(r,!1),s=this.DupOutPt(l,!0),r.Prev=l,l.Next=r,o.Next=s,s.Prev=o,e.OutPt1=r,e.OutPt2=o,!0):(o=this.DupOutPt(r,!0),s=this.DupOutPt(l,!1),r.Next=l,l.Prev=r,o.Prev=s,s.Next=o,e.OutPt1=r,e.OutPt2=o,!0))}if(p){for(o=r;r.Prev.Pt[1]===r.Pt[1]&&r.Prev!==o&&r.Prev!==l;)r=r.Prev;for(;o.Next.Pt[1]===o.Pt[1]&&o.Next!==r&&o.Next!==l;)o=o.Next;if(o.Next===r||o.Next===l)return!1;for(s=l;l.Prev.Pt[1]===l.Pt[1]&&l.Prev!==s&&l.Prev!==o;)l=l.Prev;for(;s.Next.Pt[1]===s.Pt[1]&&s.Next!==l&&s.Next!==r;)s=s.Next;if(s.Next===l||s.Next===r)return!1;var a={Left:null,Right:null};if(!this.GetOverlap(r.Pt[0],o.Pt[0],l.Pt[0],s.Pt[0],a))return!1;var P,d=a.Left,h=a.Right,f=new t.FPoint0;return r.Pt[0]>=d&&r.Pt[0]<=h?(f[0]=r.Pt[0],f[1]=r.Pt[1],t.use_xyz&&(f.Z=r.Pt.Z),P=r.Pt[0]>o.Pt[0]):l.Pt[0]>=d&&l.Pt[0]<=h?(f[0]=l.Pt[0],f[1]=l.Pt[1],t.use_xyz&&(f.Z=l.Pt.Z),P=l.Pt[0]>s.Pt[0]):o.Pt[0]>=d&&o.Pt[0]<=h?(f[0]=o.Pt[0],f[1]=o.Pt[1],t.use_xyz&&(f.Z=o.Pt.Z),P=o.Pt[0]>r.Pt[0]):(f[0]=s.Pt[0],f[1]=s.Pt[1],t.use_xyz&&(f.Z=s.Pt.Z),P=s.Pt[0]>l.Pt[0]),e.OutPt1=r,e.OutPt2=l,this.JoinHorz(r,o,l,s,f,P)}for(o=r.Next;t.FPoint.op_Equality(o.Pt,r.Pt)&&o!==r;)o=o.Next;var y=o.Pt[1]>r.Pt[1]||!t.ClipperBase.SlopesEqual4(r.Pt,o.Pt,e.OffPt);if(y){for(o=r.Prev;t.FPoint.op_Equality(o.Pt,r.Pt)&&o!==r;)o=o.Prev;if(o.Pt[1]>r.Pt[1]||!t.ClipperBase.SlopesEqual4(r.Pt,o.Pt,e.OffPt))return!1}for(s=l.Next;t.FPoint.op_Equality(s.Pt,l.Pt)&&s!==l;)s=s.Next;var m=s.Pt[1]>l.Pt[1]||!t.ClipperBase.SlopesEqual4(l.Pt,s.Pt,e.OffPt);if(m){for(s=l.Prev;t.FPoint.op_Equality(s.Pt,l.Pt)&&s!==l;)s=s.Prev;if(s.Pt[1]>l.Pt[1]||!t.ClipperBase.SlopesEqual4(l.Pt,s.Pt,e.OffPt))return!1}return o!==r&&s!==l&&o!==s&&(i!==n||y!==m)&&(y?(o=this.DupOutPt(r,!1),s=this.DupOutPt(l,!0),r.Prev=l,l.Next=r,o.Next=s,s.Prev=o,e.OutPt1=r,e.OutPt2=o,!0):(o=this.DupOutPt(r,!0),s=this.DupOutPt(l,!1),r.Next=l,l.Prev=r,o.Prev=s,s.Next=o,e.OutPt1=r,e.OutPt2=o,!0))},t.Clipper.GetBounds=function(e){for(var i=0,n=e.length;i<n&&0===e[i].length;)i++;if(i===n)return new t.FRect(0,0,0,0);var r=new t.FRect;for(r.left=e[i][0][0],r.right=r.left,r.top=e[i][0][1],r.bottom=r.top;i<n;i++)for(var o=0,l=e[i].length;o<l;o++)e[i][o][0]<r.left?r.left=e[i][o][0]:e[i][o][0]>r.right&&(r.right=e[i][o][0]),e[i][o][1]<r.top?r.top=e[i][o][1]:e[i][o][1]>r.bottom&&(r.bottom=e[i][o][1]);return r},t.Clipper.prototype.GetBounds2=function(e){var i=e,n=new t.FRect;for(n.left=e.Pt[0],n.right=e.Pt[0],n.top=e.Pt[1],n.bottom=e.Pt[1],e=e.Next;e!==i;)e.Pt[0]<n.left&&(n.left=e.Pt[0]),e.Pt[0]>n.right&&(n.right=e.Pt[0]),e.Pt[1]<n.top&&(n.top=e.Pt[1]),e.Pt[1]>n.bottom&&(n.bottom=e.Pt[1]),e=e.Next;return n},t.Clipper.PointInPolygon=function(t,e){var i=0,n=e.length;if(n<3)return 0;for(var r=e[0],o=1;o<=n;++o){var l=o===n?e[0]:e[o];if(l[1]===t[1]&&(l[0]===t[0]||r[1]===t[1]&&l[0]>t[0]==r[0]<t[0]))return-1;if(r[1]<t[1]!=l[1]<t[1])if(r[0]>=t[0])if(l[0]>t[0])i=1-i;else{if(0===(s=(r[0]-t[0])*(l[1]-t[1])-(l[0]-t[0])*(r[1]-t[1])))return-1;s>0==l[1]>r[1]&&(i=1-i)}else if(l[0]>t[0]){var s;if(0===(s=(r[0]-t[0])*(l[1]-t[1])-(l[0]-t[0])*(r[1]-t[1])))return-1;s>0==l[1]>r[1]&&(i=1-i)}r=l}return i},t.Clipper.prototype.PointInPolygon=function(t,e){var i=0,n=e,r=t[0],o=t[1],l=e.Pt[0],s=e.Pt[1];do{var p=(e=e.Next).Pt[0],u=e.Pt[1];if(u===o&&(p===r||s===o&&p>r==l<r))return-1;if(s<o!=u<o)if(l>=r)if(p>r)i=1-i;else{if(0===(a=(l-r)*(u-o)-(p-r)*(s-o)))return-1;a>0==u>s&&(i=1-i)}else if(p>r){var a;if(0===(a=(l-r)*(u-o)-(p-r)*(s-o)))return-1;a>0==u>s&&(i=1-i)}l=p,s=u}while(n!==e);return i},t.Clipper.prototype.Poly2ContainsPoly1=function(t,e){var i=t;do{var n=this.PointInPolygon(i.Pt,e);if(n>=0)return n>0;i=i.Next}while(i!==t);return!0},t.Clipper.prototype.FixupFirstLefts1=function(e,i){for(var n,r,o=0,l=this.m_PolyOuts.length;o<l;o++)n=this.m_PolyOuts[o],r=t.Clipper.ParseFirstLeft(n.FirstLeft),null!==n.Pts&&r===e&&this.Poly2ContainsPoly1(n.Pts,i.Pts)&&(n.FirstLeft=i)},t.Clipper.prototype.FixupFirstLefts2=function(e,i){for(var n,r,o=i.FirstLeft,l=0,s=this.m_PolyOuts.length;l<s;l++)null!==(n=this.m_PolyOuts[l]).Pts&&n!==i&&n!==e&&((r=t.Clipper.ParseFirstLeft(n.FirstLeft))!==o&&r!==e&&r!==i||(this.Poly2ContainsPoly1(n.Pts,e.Pts)?n.FirstLeft=e:this.Poly2ContainsPoly1(n.Pts,i.Pts)?n.FirstLeft=i:n.FirstLeft!==e&&n.FirstLeft!==i||(n.FirstLeft=o)))},t.Clipper.prototype.FixupFirstLefts3=function(e,i){for(var n,r,o=0,l=this.m_PolyOuts.length;o<l;o++)n=this.m_PolyOuts[o],r=t.Clipper.ParseFirstLeft(n.FirstLeft),null!==n.Pts&&r===e&&(n.FirstLeft=i)},t.Clipper.ParseFirstLeft=function(t){for(;null!==t&&null===t.Pts;)t=t.FirstLeft;return t},t.Clipper.prototype.JoinCommonEdges=function(){for(var t=this,e=0,i=this.m_Joins.length;e<i;e++){var n,r=t.m_Joins[e],o=t.GetOutRec(r.OutPt1.Idx),l=t.GetOutRec(r.OutPt2.Idx);if(null!==o.Pts&&null!==l.Pts)if(!o.IsOpen&&!l.IsOpen)n=o===l?o:t.OutRec1RightOfOutRec2(o,l)?l:t.OutRec1RightOfOutRec2(l,o)?o:t.GetLowermostRec(o,l),t.JoinPoints(r,o,l)&&(o===l?(o.Pts=r.OutPt1,o.BottomPt=null,(l=t.CreateOutRec()).Pts=r.OutPt2,t.UpdateOutPtIdxs(l),t.Poly2ContainsPoly1(l.Pts,o.Pts)?(l.IsHole=!o.IsHole,l.FirstLeft=o,t.m_UsingPolyTree&&t.FixupFirstLefts2(l,o),(l.IsHole^t.ReverseSolution)==t.Area$1(l)>0&&t.ReversePolyPtLinks(l.Pts)):t.Poly2ContainsPoly1(o.Pts,l.Pts)?(l.IsHole=o.IsHole,o.IsHole=!l.IsHole,l.FirstLeft=o.FirstLeft,o.FirstLeft=l,t.m_UsingPolyTree&&t.FixupFirstLefts2(o,l),(o.IsHole^t.ReverseSolution)==t.Area$1(o)>0&&t.ReversePolyPtLinks(o.Pts)):(l.IsHole=o.IsHole,l.FirstLeft=o.FirstLeft,t.m_UsingPolyTree&&t.FixupFirstLefts1(o,l))):(l.Pts=null,l.BottomPt=null,l.Idx=o.Idx,o.IsHole=n.IsHole,n===l&&(o.FirstLeft=l.FirstLeft),l.FirstLeft=o,t.m_UsingPolyTree&&t.FixupFirstLefts3(l,o)))}},t.Clipper.prototype.UpdateOutPtIdxs=function(t){var e=t.Pts;do{e.Idx=t.Idx,e=e.Prev}while(e!==t.Pts)},t.Clipper.prototype.DoSimplePolygons=function(){for(var e=this,i=0;i<this.m_PolyOuts.length;){var n=e.m_PolyOuts[i++],r=n.Pts;if(null!==r&&!n.IsOpen)do{for(var o=r.Next;o!==n.Pts;){if(t.FPoint.op_Equality(r.Pt,o.Pt)&&o.Next!==r&&o.Prev!==r){var l=r.Prev,s=o.Prev;r.Prev=s,s.Next=r,o.Prev=l,l.Next=o,n.Pts=r;var p=e.CreateOutRec();p.Pts=o,e.UpdateOutPtIdxs(p),e.Poly2ContainsPoly1(p.Pts,n.Pts)?(p.IsHole=!n.IsHole,p.FirstLeft=n,e.m_UsingPolyTree&&e.FixupFirstLefts2(p,n)):e.Poly2ContainsPoly1(n.Pts,p.Pts)?(p.IsHole=n.IsHole,n.IsHole=!p.IsHole,p.FirstLeft=n.FirstLeft,n.FirstLeft=p,e.m_UsingPolyTree&&e.FixupFirstLefts2(n,p)):(p.IsHole=n.IsHole,p.FirstLeft=n.FirstLeft,e.m_UsingPolyTree&&e.FixupFirstLefts1(n,p)),o=r}o=o.Next}r=r.Next}while(r!==n.Pts)}},t.Clipper.Area=function(t){if(!Array.isArray(t))return 0;var e=t.length;if(e<3)return 0;for(var i=0,n=0,r=e-1;n<e;++n)i+=(t[r][0]+t[n][0])*(t[r][1]-t[n][1]),r=n;return.5*-i},t.Clipper.prototype.Area=function(t){var e=t;if(null===t)return 0;var i=0;do{i+=(t.Prev.Pt[0]+t.Pt[0])*(t.Prev.Pt[1]-t.Pt[1]),t=t.Next}while(t!==e);return.5*i},t.Clipper.prototype.Area$1=function(t){return this.Area(t.Pts)},t.Clipper.SimplifyPolygon=function(e,i){var n=new Array,r=new t.Clipper(0);return r.StrictlySimple=!0,r.AddPath(e,t.PolyType.ptSubject,!0),r.Execute(t.ClipType.ctUnion,n,i,i),n},t.Clipper.SimplifyPolygons=function(e,i){void 0===i&&(i=t.PolyFillType.pftEvenOdd);var n=new Array,r=new t.Clipper(0);return r.StrictlySimple=!0,r.AddPaths(e,t.PolyType.ptSubject,!0),r.Execute(t.ClipType.ctUnion,n,i,i),n},t.Clipper.DistanceSqrd=function(t,e){var i=t[0]-e[0],n=t[1]-e[1];return i*i+n*n},t.Clipper.DistanceFromLineSqrd=function(t,e,i){var n=e[1]-i[1],r=i[0]-e[0],o=n*e[0]+r*e[1];return(o=n*t[0]+r*t[1]-o)*o/(n*n+r*r)},t.Clipper.SlopesNearCollinear=function(e,i,n,r){return Math.abs(e[0]-i[0])>Math.abs(e[1]-i[1])?e[0]>i[0]==e[0]<n[0]?t.Clipper.DistanceFromLineSqrd(e,i,n)<r:i[0]>e[0]==i[0]<n[0]?t.Clipper.DistanceFromLineSqrd(i,e,n)<r:t.Clipper.DistanceFromLineSqrd(n,e,i)<r:e[1]>i[1]==e[1]<n[1]?t.Clipper.DistanceFromLineSqrd(e,i,n)<r:i[1]>e[1]==i[1]<n[1]?t.Clipper.DistanceFromLineSqrd(i,e,n)<r:t.Clipper.DistanceFromLineSqrd(n,e,i)<r},t.Clipper.PointsAreClose=function(t,e,i){var n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r<=i},t.Clipper.ExcludeOp=function(t){var e=t.Prev;return e.Next=t.Next,t.Next.Prev=e,e.Idx=0,e},t.Clipper.CleanPolygon=function(e,i){void 0===i&&(i=1.415);var n=e.length;if(0===n)return new Array;for(var r=new Array(n),o=0;o<n;++o)r[o]=new t.OutPt;for(o=0;o<n;++o)r[o].Pt=e[o],r[o].Next=r[(o+1)%n],r[o].Next.Prev=r[o],r[o].Idx=0;for(var l=i*i,s=r[0];0===s.Idx&&s.Next!==s.Prev;)t.Clipper.PointsAreClose(s.Pt,s.Prev.Pt,l)?(s=t.Clipper.ExcludeOp(s),n--):t.Clipper.PointsAreClose(s.Prev.Pt,s.Next.Pt,l)?(t.Clipper.ExcludeOp(s.Next),s=t.Clipper.ExcludeOp(s),n-=2):t.Clipper.SlopesNearCollinear(s.Prev.Pt,s.Pt,s.Next.Pt,l)?(s=t.Clipper.ExcludeOp(s),n--):(s.Idx=1,s=s.Next);n<3&&(n=0);var p=new Array(n);for(o=0;o<n;++o)p[o]=new t.FPoint1(s.Pt),s=s.Next;return r=null,p},t.Clipper.CleanPolygons=function(e,i){for(var n=new Array(e.length),r=0,o=e.length;r<o;r++)n[r]=t.Clipper.CleanPolygon(e[r],i);return n},t.Clipper.Minkowski=function(e,i,n,r){var o=r?1:0,l=e.length,s=i.length,p=new Array;if(n)for(var u=0;u<s;u++){for(var a=new Array(l),P=0,d=e.length,h=e[P];P<d;h=e[++P])a[P]=new t.FPoint2(i[u][0]+h[0],i[u][1]+h[1]);p.push(a)}else for(u=0;u<s;u++){for(a=new Array(l),P=0,d=e.length,h=e[P];P<d;h=e[++P])a[P]=new t.FPoint2(i[u][0]-h[0],i[u][1]-h[1]);p.push(a)}var f=new Array;for(u=0;u<s-1+o;u++)for(P=0;P<l;P++){var y=new Array;y.push(p[u%s][P%l]),y.push(p[(u+1)%s][P%l]),y.push(p[(u+1)%s][(P+1)%l]),y.push(p[u%s][(P+1)%l]),t.Clipper.Orientation(y)||y.reverse(),f.push(y)}return f},t.Clipper.MinkowskiSum=function(e,i,n){if(i[0]instanceof Array){u=i;for(var r=new t.Paths,o=(s=new t.Clipper,0);o<u.length;++o){var l=t.Clipper.Minkowski(e,u[o],!0,n);if(s.AddPaths(l,t.PolyType.ptSubject,!0),n){p=t.Clipper.TranslatePath(u[o],e[0]);s.AddPath(p,t.PolyType.ptClip,!0)}}return s.Execute(t.ClipType.ctUnion,r,t.PolyFillType.pftNonZero,t.PolyFillType.pftNonZero),r}var s,p=i,u=t.Clipper.Minkowski(e,p,!0,n);return(s=new t.Clipper).AddPaths(u,t.PolyType.ptSubject,!0),s.Execute(t.ClipType.ctUnion,u,t.PolyFillType.pftNonZero,t.PolyFillType.pftNonZero),u},t.Clipper.TranslatePath=function(e,i){for(var n=new t.Path,r=0;r<e.length;r++)n.push(new t.FPoint2(e[r][0]+i[0],e[r][1]+i[1]));return n},t.Clipper.MinkowskiDiff=function(e,i){var n=t.Clipper.Minkowski(e,i,!1,!0),r=new t.Clipper;return r.AddPaths(n,t.PolyType.ptSubject,!0),r.Execute(t.ClipType.ctUnion,n,t.PolyFillType.pftNonZero,t.PolyFillType.pftNonZero),n},t.Clipper.PolyTreeToPaths=function(e){var i=new Array;return t.Clipper.AddPolyNodeToPaths(e,t.Clipper.NodeType.ntAny,i),i},t.Clipper.AddPolyNodeToPaths=function(e,i,n){var r=!0;switch(i){case t.Clipper.NodeType.ntOpen:return;case t.Clipper.NodeType.ntClosed:r=!e.IsOpen}e.m_polygon.length>0&&r&&n.push(e.m_polygon);for(var o=0,l=e.Childs(),s=l.length,p=l[o];o<s;p=l[++o])t.Clipper.AddPolyNodeToPaths(p,i,n)},t.Clipper.OpenPathsFromPolyTree=function(e){for(var i=new t.Paths,n=0,r=e.ChildCount();n<r;n++)e.Childs()[n].IsOpen&&i.push(e.Childs()[n].m_polygon);return i},t.Clipper.ClosedPathsFromPolyTree=function(e){var i=new t.Paths;return t.Clipper.AddPolyNodeToPaths(e,t.Clipper.NodeType.ntClosed,i),i},e(t.Clipper,t.ClipperBase),t.Clipper.NodeType={ntAny:0,ntOpen:1,ntClosed:2},t.ClipperOffset=function(e,i){void 0===e&&(e=2),void 0===i&&(i=t.ClipperOffset.def_arc_tolerance),this.m_destPolys=new t.Paths,this.m_srcPoly=new t.Path,this.m_destPoly=new t.Path,this.m_normals=new Array,this.m_delta=0,this.m_sinA=0,this.m_sin=0,this.m_cos=0,this.m_miterLim=0,this.m_StepsPerRad=0,this.m_lowest=new t.FPoint0,this.m_polyNodes=new t.PolyNode,this.MiterLimit=e,this.ArcTolerance=i,this.m_lowest[0]=-1},t.ClipperOffset.two_pi=6.28318530717959,t.ClipperOffset.def_arc_tolerance=.25,t.ClipperOffset.prototype.Clear=function(){t.Clear(this.m_polyNodes.Childs()),this.m_lowest[0]=-1},t.ClipperOffset.prototype.AddPath=function(e,i,n){var r=e.length-1;if(!(r<0)){var o=new t.PolyNode;if(o.m_jointype=i,o.m_endtype=n,n===t.EndType.etClosedLine||n===t.EndType.etClosedPolygon)for(;r>0&&t.FPoint.op_Equality(e[0],e[r]);)r--;o.m_polygon.push(e[0]);for(var l=0,s=0,p=1;p<=r;p++)t.FPoint.op_Inequality(o.m_polygon[l],e[p])&&(l++,o.m_polygon.push(e[p]),(e[p][1]>o.m_polygon[s][1]||e[p][1]===o.m_polygon[s][1]&&e[p][0]<o.m_polygon[s][0])&&(s=l));if(!(n===t.EndType.etClosedPolygon&&l<2)&&(this.m_polyNodes.AddChild(o),n===t.EndType.etClosedPolygon))if(this.m_lowest[0]<0)this.m_lowest=new t.FPoint2(this.m_polyNodes.ChildCount()-1,s);else{var u=this.m_polyNodes.Childs()[this.m_lowest[0]].m_polygon[this.m_lowest[1]];(o.m_polygon[s][1]>u[1]||o.m_polygon[s][1]===u[1]&&o.m_polygon[s][0]<u[0])&&(this.m_lowest=new t.FPoint2(this.m_polyNodes.ChildCount()-1,s))}}},t.ClipperOffset.prototype.AddPaths=function(t,e,i){for(var n=0,r=t.length;n<r;n++)this.AddPath(t[n],e,i)},t.ClipperOffset.prototype.FixOrientations=function(){if(this.m_lowest[0]>=0&&!t.Clipper.Orientation(this.m_polyNodes.Childs()[this.m_lowest[0]].m_polygon))for(var e=0;e<this.m_polyNodes.ChildCount();e++){((i=this.m_polyNodes.Childs()[e]).m_endtype===t.EndType.etClosedPolygon||i.m_endtype===t.EndType.etClosedLine&&t.Clipper.Orientation(i.m_polygon))&&i.m_polygon.reverse()}else for(e=0;e<this.m_polyNodes.ChildCount();e++){var i;(i=this.m_polyNodes.Childs()[e]).m_endtype!==t.EndType.etClosedLine||t.Clipper.Orientation(i.m_polygon)||i.m_polygon.reverse()}},t.ClipperOffset.GetUnitNormal=function(e,i){var n=i[0]-e[0],r=i[1]-e[1];if(0===n&&0===r)return new t.FPoint2(0,0);var o=1/Math.sqrt(n*n+r*r);return n*=o,r*=o,new t.FPoint2(r,-n)},t.ClipperOffset.prototype.DoOffset=function(e){var i=this;if(this.m_destPolys=new Array,this.m_delta=e,t.ClipperBase.near_zero(e))for(var n=0;n<this.m_polyNodes.ChildCount();n++){(l=i.m_polyNodes.Childs()[n]).m_endtype===t.EndType.etClosedPolygon&&i.m_destPolys.push(l.m_polygon)}else{var r;this.MiterLimit>2?this.m_miterLim=2/(this.MiterLimit*this.MiterLimit):this.m_miterLim=.5,r=this.ArcTolerance<=0?t.ClipperOffset.def_arc_tolerance:this.ArcTolerance>Math.abs(e)*t.ClipperOffset.def_arc_tolerance?Math.abs(e)*t.ClipperOffset.def_arc_tolerance:this.ArcTolerance;var o=3.14159265358979/Math.acos(1-r/Math.abs(e));this.m_sin=Math.sin(t.ClipperOffset.two_pi/o),this.m_cos=Math.cos(t.ClipperOffset.two_pi/o),this.m_StepsPerRad=o/t.ClipperOffset.two_pi,e<0&&(this.m_sin=-this.m_sin);for(n=0;n<this.m_polyNodes.ChildCount();n++){var l=i.m_polyNodes.Childs()[n];i.m_srcPoly=l.m_polygon;var s=i.m_srcPoly.length;if(!(0===s||e<=0&&(s<3||l.m_endtype!==t.EndType.etClosedPolygon)))if(i.m_destPoly=new Array,1!==s){i.m_normals.length=0;for(h=0;h<s-1;h++)i.m_normals.push(t.ClipperOffset.GetUnitNormal(i.m_srcPoly[h],i.m_srcPoly[h+1]));if(l.m_endtype===t.EndType.etClosedLine||l.m_endtype===t.EndType.etClosedPolygon?i.m_normals.push(t.ClipperOffset.GetUnitNormal(i.m_srcPoly[s-1],i.m_srcPoly[0])):i.m_normals.push(new t.FPoint1(i.m_normals[s-2])),l.m_endtype===t.EndType.etClosedPolygon){var p=s-1;for(h=0;h<s;h++)p=i.OffsetPoint(h,p,l.m_jointype);i.m_destPolys.push(i.m_destPoly)}else if(l.m_endtype===t.EndType.etClosedLine){for(p=s-1,h=0;h<s;h++)p=i.OffsetPoint(h,p,l.m_jointype);i.m_destPolys.push(i.m_destPoly),i.m_destPoly=new Array;var u=i.m_normals[s-1];for(h=s-1;h>0;h--)i.m_normals[h]=new t.FPoint2(-i.m_normals[h-1][0],-i.m_normals[h-1][1]);i.m_normals[0]=new t.FPoint2(-u[0],-u[1]),p=0;for(h=s-1;h>=0;h--)p=i.OffsetPoint(h,p,l.m_jointype);i.m_destPolys.push(i.m_destPoly)}else{var a;for(p=0,h=1;h<s-1;++h)p=i.OffsetPoint(h,p,l.m_jointype);if(l.m_endtype===t.EndType.etOpenButt){h=s-1;a=new t.FPoint2(i.m_srcPoly[h][0]+i.m_normals[h][0]*e,i.m_srcPoly[h][1]+i.m_normals[h][1]*e),i.m_destPoly.push(a),a=new t.FPoint2(i.m_srcPoly[h][0]-i.m_normals[h][0]*e,i.m_srcPoly[h][1]-i.m_normals[h][1]*e),i.m_destPoly.push(a)}else{h=s-1;p=s-2,i.m_sinA=0,i.m_normals[h]=new t.FPoint2(-i.m_normals[h][0],-i.m_normals[h][1]),l.m_endtype===t.EndType.etOpenSquare?i.DoSquare(h,p):i.DoRound(h,p)}for(h=s-1;h>0;h--)i.m_normals[h]=new t.FPoint2(-i.m_normals[h-1][0],-i.m_normals[h-1][1]);i.m_normals[0]=new t.FPoint2(-i.m_normals[1][0],-i.m_normals[1][1]);for(h=(p=s-1)-1;h>0;--h)p=i.OffsetPoint(h,p,l.m_jointype);l.m_endtype===t.EndType.etOpenButt?(a=new t.FPoint2(i.m_srcPoly[0][0]-i.m_normals[0][0]*e,i.m_srcPoly[0][1]-i.m_normals[0][1]*e),i.m_destPoly.push(a),a=new t.FPoint2(i.m_srcPoly[0][0]+i.m_normals[0][0]*e,i.m_srcPoly[0][1]+i.m_normals[0][1]*e),i.m_destPoly.push(a)):(p=1,i.m_sinA=0,l.m_endtype===t.EndType.etOpenSquare?i.DoSquare(0,1):i.DoRound(0,1)),i.m_destPolys.push(i.m_destPoly)}}else{if(l.m_jointype===t.JoinType.jtRound)for(var P=1,d=0,h=1;h<=o;h++){i.m_destPoly.push(new t.FPoint2(i.m_srcPoly[0][0]+P*e,i.m_srcPoly[0][1]+d*e));var f=P;P=P*i.m_cos-i.m_sin*d,d=f*i.m_sin+d*i.m_cos}else{P=-1,d=-1;for(var h=0;h<4;++h)i.m_destPoly.push(new t.FPoint2(i.m_srcPoly[0][0]+P*e,i.m_srcPoly[0][1]+d*e)),P<0?P=1:d<0?d=1:P=-1}i.m_destPolys.push(i.m_destPoly)}}}},t.ClipperOffset.prototype.Execute=function(){var e=arguments;if(e[0]instanceof t.PolyTree){o=e[0],l=e[1];if(o.Clear(),this.FixOrientations(),this.DoOffset(l),(r=new t.Clipper(0)).AddPaths(this.m_destPolys,t.PolyType.ptSubject,!0),l>0)r.Execute(t.ClipType.ctUnion,o,t.PolyFillType.pftPositive,t.PolyFillType.pftPositive);else{p=t.Clipper.GetBounds(this.m_destPolys);if((s=new t.Path).push(new t.FPoint2(p.left-10,p.bottom+10)),s.push(new t.FPoint2(p.right+10,p.bottom+10)),s.push(new t.FPoint2(p.right+10,p.top-10)),s.push(new t.FPoint2(p.left-10,p.top-10)),r.AddPath(s,t.PolyType.ptSubject,!0),r.ReverseSolution=!0,r.Execute(t.ClipType.ctUnion,o,t.PolyFillType.pftNegative,t.PolyFillType.pftNegative),1===o.ChildCount()&&o.Childs()[0].ChildCount()>0){var i=o.Childs()[0];o.Childs()[0]=i.Childs()[0],o.Childs()[0].m_Parent=o;for(var n=1;n<i.ChildCount();n++)o.AddChild(i.Childs()[n])}else o.Clear()}}else{var r,o=e[0],l=e[1];if(t.Clear(o),this.FixOrientations(),this.DoOffset(l),(r=new t.Clipper(0)).AddPaths(this.m_destPolys,t.PolyType.ptSubject,!0),l>0)r.Execute(t.ClipType.ctUnion,o,t.PolyFillType.pftPositive,t.PolyFillType.pftPositive);else{var s,p=t.Clipper.GetBounds(this.m_destPolys);(s=new t.Path).push(new t.FPoint2(p.left-10,p.bottom+10)),s.push(new t.FPoint2(p.right+10,p.bottom+10)),s.push(new t.FPoint2(p.right+10,p.top-10)),s.push(new t.FPoint2(p.left-10,p.top-10)),r.AddPath(s,t.PolyType.ptSubject,!0),r.ReverseSolution=!0,r.Execute(t.ClipType.ctUnion,o,t.PolyFillType.pftNegative,t.PolyFillType.pftNegative),o.length>0&&o.splice(0,1)}}},t.ClipperOffset.prototype.OffsetPoint=function(t,e,i){return this.m_sinA=this.m_normals[e][0]*this.m_normals[t][1]-this.m_normals[t][0]*this.m_normals[e][1],0===this.m_sinA?e:(this.m_sinA<5e-5&&this.m_sinA>-5e-5&&console.log(this.m_sinA),e)},t.ClipperOffset.prototype.DoSquare=function(e,i){var n=Math.tan(Math.atan2(this.m_sinA,this.m_normals[i][0]*this.m_normals[e][0]+this.m_normals[i][1]*this.m_normals[e][1])/4);this.m_destPoly.push(new t.FPoint2(this.m_srcPoly[e][0]+this.m_delta*(this.m_normals[i][0]-this.m_normals[i][1]*n),this.m_srcPoly[e][1]+this.m_delta*(this.m_normals[i][1]+this.m_normals[i][0]*n))),this.m_destPoly.push(new t.FPoint2(this.m_srcPoly[e][0]+this.m_delta*(this.m_normals[e][0]+this.m_normals[e][1]*n),this.m_srcPoly[e][1]+this.m_delta*(this.m_normals[e][1]-this.m_normals[e][0]*n)))},t.ClipperOffset.prototype.DoMiter=function(e,i,n){var r=this.m_delta/n;this.m_destPoly.push(new t.FPoint2(this.m_srcPoly[e][0]+(this.m_normals[i][0]+this.m_normals[e][0])*r,this.m_srcPoly[e][1]+(this.m_normals[i][1]+this.m_normals[e][1])*r))},t.ClipperOffset.prototype.DoRound=function(e,i){for(var n,r=this,o=Math.atan2(this.m_sinA,this.m_normals[i][0]*this.m_normals[e][0]+this.m_normals[i][1]*this.m_normals[e][1]),l=Math.max(Math.round(this.m_StepsPerRad*Math.abs(o)),1),s=this.m_normals[i][0],p=this.m_normals[i][1],u=0;u<l;++u)r.m_destPoly.push(new t.FPoint2(r.m_srcPoly[e][0]+s*r.m_delta,r.m_srcPoly[e][1]+p*r.m_delta)),n=s,s=s*r.m_cos-r.m_sin*p,p=n*r.m_sin+p*r.m_cos;this.m_destPoly.push(new t.FPoint2(this.m_srcPoly[e][0]+this.m_normals[e][0]*this.m_delta,this.m_srcPoly[e][1]+this.m_normals[e][1]*this.m_delta))},t.Error=function(t){try{throw new Error(t)}catch(t){alert(t.message)}},t.JS={},t.JS.AreaOfPolygon=function(e){return t.Clipper.Area(e)},t.JS.AreaOfPolygons=function(e){for(var i=0,n=0;n<e.length;n++)i+=t.Clipper.Area(e[n]);return i},t.JS.BoundsOfPath=function(e){return t.JS.BoundsOfPaths([e])},t.JS.BoundsOfPaths=function(e){return t.Clipper.GetBounds(e)},t.JS.Clean=function(e,i){if(!(e instanceof Array))return[];var n=e[0]instanceof Array;e=t.JS.Clone(e);if("number"!=typeof i||null===i)return t.Error("Delta is not a number in Clean()."),e;if(0===e.length||1===e.length&&0===e[0].length||i<0)return e;n||(e=[e]);for(var r,o,l,s,p,u,a,P=e.length,d=[],h=0;h<P;h++)if(0!==(r=(o=e[h]).length))if(r<3)l=o,d.push(l);else{for(l=o,s=i*i,p=o[0],u=1,a=1;a<r;a++)(o[a][0]-p[0])*(o[a][0]-p[0])+(o[a][1]-p[1])*(o[a][1]-p[1])<=s||(l[u]=o[a],p=o[a],u++);p=o[u-1],(o[0][0]-p[0])*(o[0][0]-p[0])+(o[0][1]-p[1])*(o[0][1]-p[1])<=s&&u--,u<r&&l.splice(u,r-u),l.length&&d.push(l)}return!n&&d.length?d=d[0]:n||0!==d.length?n&&0===d.length&&(d=[[]]):d=[],d},t.JS.Clone=function(t){if(!(t instanceof Array))return[];if(0===t.length)return[];if(1===t.length&&0===t[0].length)return[[]];var e=t[0]instanceof Array;e||(t=[t]);var i,n,r,o,l=t.length,s=new Array(l);for(n=0;n<l;n++){for(i=t[n].length,o=new Array(i),r=0;r<i;r++)o[r]={X:t[n][r][0],Y:t[n][r][1]};s[n]=o}return e||(s=s[0]),s},t.JS.Lighten=function(e,i){if(!(e instanceof Array))return[];if("number"!=typeof i||null===i)return t.Error("Tolerance is not a number in Lighten()."),t.JS.Clone(e);if(0===e.length||1===e.length&&0===e[0].length||i<0)return t.JS.Clone(e);var n,r,o,l,s,p,u,a,P,d,h,f,y,m,C,x,c=e[0]instanceof Array;c||(e=[e]);var v=e.length,_=i*i,I=[];for(n=0;n<v;n++)if(0!==(p=(o=e[n]).length)){for(l=0;l<1e6;l++){for(s=[],o[(p=o.length)-1][0]!==o[0][0]||o[p-1][1]!==o[0][1]?(h=1,o.push({X:o[0][0],Y:o[0][1]}),p=o.length):h=0,d=[],r=0;r<p-2;r++)u=o[r],P=o[r+1],a=o[r+2],C=u[0],x=u[1],f=a[0]-C,y=a[1]-x,0===f&&0===y||((m=((P[0]-C)*f+(P[1]-x)*y)/(f*f+y*y))>1?(C=a[0],x=a[1]):m>0&&(C+=f*m,x+=y*m)),(f=P[0]-C)*f+(y=P[1]-x)*y<=_&&(d[r+1]=1,r++);for(s.push({X:o[0][0],Y:o[0][1]}),r=1;r<p-1;r++)d[r]||s.push({X:o[r][0],Y:o[r][1]});if(s.push({X:o[p-1][0],Y:o[p-1][1]}),h&&o.pop(),!d.length)break;o=s}s[(p=s.length)-1][0]===s[0][0]&&s[p-1][1]===s[0][1]&&s.pop(),s.length>2&&I.push(s)}return c||(I=I[0]),void 0===I&&(I=[]),I},t.JS.PerimeterOfPath=function(t,e){if(void 0===t)return 0;var i,n,r=Math.sqrt,o=0,l=0,s=0,p=0,u=0,a=t.length;if(a<2)return 0;for(e&&(t[a]=t[0],a++);--a;)l=(i=t[a])[0],s=i[1],o+=r((l-(p=(n=t[a-1])[0]))*(l-p)+(s-(u=n[1]))*(s-u));return e&&t.pop(),o},t.JS.PerimeterOfPaths=function(e,i){for(var n=0,r=0;r<e.length;r++)n+=t.JS.PerimeterOfPath(e[r],i);return n},t.ExPolygons=function(){return[]},t.ExPolygon=function(){this.outer=null,this.holes=null},t.JS.AddOuterPolyNodeToExPolygons=function(e,i){var n=new t.ExPolygon;n.outer=e.Contour();var r,o,l,s,p,u,a=e.Childs(),P=a.length;for(n.holes=new Array(P),l=0;l<P;l++)for(r=a[l],n.holes[l]=r.Contour(),s=0,u=(p=r.Childs()).length;s<u;s++)o=p[s],t.JS.AddOuterPolyNodeToExPolygons(o,i);i.push(n)},t.JS.ExPolygonsToPaths=function(e){var i,n,r,o,l=new t.Paths;for(i=0,r=e.length;i<r;i++)for(l.push(e[i].outer),n=0,o=e[i].holes.length;n<o;n++)l.push(e[i].holes[n]);return l},t.JS.PolyTreeToExPolygons=function(e){var i,n,r,o,l=new t.ExPolygons;for(n=0,o=(r=e.Childs()).length;n<o;n++)i=r[n],t.JS.AddOuterPolyNodeToExPolygons(i,l);return l},module.exports=t});
//# sourceMappingURL=clipper-fpoint.umd.js.map
